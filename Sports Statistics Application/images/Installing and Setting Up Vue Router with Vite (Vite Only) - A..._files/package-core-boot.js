sndefine("core-sleeknote",(function(){})),sndefine("constants",[],(function(){return{CORE:{EVENTS:{EXIT:"exit",ENTRY:"entry",LOAD:"load",SUBMIT:"submit",SITEDATA:"sitedata",READY:"ready",STORAGE:"storage",VISIBLE:"visible",PRODUCTREC:"productrec",ANIMATING:"animating",CLICK:"click"},CREATOR:{USER:"user",API:"api",QUEUE:"queue"},COMMANDS:{SUBMIT:"submitted",CLICK:"click",CURRENT:"current",OPEN:"open",QUEUE:"queue",CLOSE:"close",REVEAL:"reveal",MAXIMIZE:"maximize",MINIMIZE:"minimize"},API:{BUSY:"busy",ADD:"add",CLOSE:"close",CLOSEALL:"closeall",STATUS:"status",CAMPAIGNS:"campaigns",OPEN:"open",REVEAL:"reveal",QUEUE:"push",MAXIMIZE:"maximize",MINIMIZE:"minimize",REMOVE:"remove",NOTE_RERENDER:"rerender",NOTE_CONFIG:"config",APPLY_CONFIG:"apply",AFTERRENDER:"onafterrender",VISIBLE:"visible",WAIT:"wait",POSITION:"position",MERGE:"merge",HOOK:"hook",LAUNCH:"launch",EVALUATE:"evaluate"},LOGLEVELS:{CS:"1",CORE:"a",TRACKER:"t",EDITORTARGETING:"targeting"},FORMATTERS:{CONFIG:"config",EVALUATOR:"evaluator",CORE:"core",SNDEBUG:"sndebug"}},ELEMENTTYPES:["text","image","input","input-number","phone","checkbox","button","textarea","radio","linkbutton","spacer","sticker","close","select","container","group-sms","group-question","counter","clerk","customcatalogrec","raptor","helloretail","gmerch","shopifyfeed","video","spintowin","date","code"],MIMIR:{EVENTS:{PAGERELOAD:"1_pagereload",PAGEVIEW:"2_pageview",SHOWN:"3_sleeknote_shown",ENGAGED:"4_sleeknote_engaged",CLOSED:"5_sleeknote_closed",LINK_CLICKED:"6_sleeknote_link_clicked",GOAL_CONVERTED:"7_goal_converted",TEASER_CLOSED:"8_sleeknote_teaser_closed",SUBSTEP_ENGAGED:"11_sleeknote_substep_engaged"},TRIGGERS:{TIMER:"1_sleeknote_trigger_shown_after",SCROLL:"2_sleeknote_trigger_scroll",EXIT:"3_sleeknote_exit_intent",MANUAL:"4_sleeknote_trigger_manual",TEASERCLICK:"5_sleeknote_teaser_clicked",MOUSESUBMIT:"6_sleeknote_submitbutton_clicked",KEYPRESSSUBMIT:"7_sleeknote_submitbutton_enterpress",CLOSEBUTTON:"8_sleeknote_closebutton_clicked",DISMISS:"9_sleeknote_dismissed",TEASERCLOSE:"10_sleeknote_teaser_closebutton_clicked",LINKBUTTON:"12_sleeknote_linkbutton_clicked",CLICK:"13_sleeknote_trigger_click",SITEDATA:"14_sleeknote_trigger_sitedata",EMBEDDED:"15_embedded_campaign_show"},NOTES:{NEWSLETTER:"1_Newsletter",PROMOTE:"2_Promote",CONTACT:"3_Contact",BLANK:"2_Promote"}},IMAGEMAXSIZE:25e4,PROFILE:{UNKN:1,IGNORE:2,DESKTOP:3,TABLET:4,MOBILE:5},PROFILEIDS:{DESKTOP:"desktop",MOBILE:"mobile"},POS:{POPUP:5,BOTTOM_LEFT:7,BOTTOM_RIGHT:9,CENTER_LEFT:4,CENTER_RIGHT:6,SLIDEUP:10,SLIDEUP2:11,HELLO:12,HELLO2:17,POPUP2:13,POPUP7:15,POPUP9:16,POPUP5:18,EMBEDDED:20,SIDEBAR_LEFT:21,SIDEBAR_RIGHT:22},AL:{TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4},PA:{CENTER:1,INSIDE:2,OUTSIDE:3,RIGHT:4,LEFT:5,BOTTOM:6,TOP:7},TARGETING:{VISIBILITY:{SHOW:"include",HIDE:"exclude"},TYPES:{MATCHES:"exactMatch",CONTAINS:"contains"},RELATIONS:{AND:"AND",OR:"OR"}},TRIGGERS:{TYPES:{1:"Show After",2:"Scroll",3:"Exit-Intent",4:"Manual",5:"Click",6:"Automated",7:"SiteData"}},CONDITIONS:{PAGESVISITEDOPTIONS:{ONESESSION:"current session",ALLSESSIONS:"all sessions"},UTMSOURCE:"utm_source",UTMMEDIUM:"utm_medium",UTMCAMPAIGN:"utm_campaign",UTMTERM:"utm_term",UTMCONTENT:"utm_content",GROUPS:{AND:!0,OR:!1},KEYS:{SEQUENCE:"sequence",SUBSCRIBER:"currentSubscriber",VISITOR:"newVisitor",QUERY:"specificQuery",REFERRAL:"specificReferral",UTM:"utm",SHOW:"showCount",COOKIE:"specificCookie",GEOTARGETING:"geotargeting",ELEMENT:"htmlElement",SITE:"siteData",PAGE:"pageCount",TARGETING:"specificURL",NOTARGETING:"targetAll",IP:"specificIP",URLMATCHES:"URLMatches",URLCONTAINS:"URLContains"},TYPES:{EXISTS:"exists",NOTEXISTS:"notExists",EXACTMATCH:"exactMatch",NOTEXACTMATCH:"notExactMatch",CONTAINS:"contains",LESSTHAN:"lessThan",LESSTHANEQ:"lessThanEq",GREATERTHAN:"greaterThan",GREATERTHANEQ:"greaterThanEq",EQUALS:"equals"},MATCHTYPES:{INCLUDE:"include",EXCLUDE:"exclude",NONE:"none",BOTH:"both"}},SUNDAY:0,MONDAY:1,DATETIMEFORMAT:"DD-MM-YYYY - HH:mm",DATEFORMAT:"DD-MM-YYYY",ISODATEFORMAT:"YYYY-MM-DD",TIMEFORMAT:"- HH:mm",SCHEDULERDATEFORMAT:"YYYY/MM/DD",SETUPDATEFORMAT:"Do MMMM YYYY",URLPATTERN:"^((?:https?:\\/\\/)?[^./]+(?:\\.[^./]+)+(?:\\/.*)?)$",IPPATTERN:"^((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)(,\\n|,?|,\\s))*$",SHOPIFYURLPATTERN:"^.*products.json$",INPUTNAMEALLOWEDPATTERN:"^[a-zA-Z][\\w:.-]*$",MYCAMPAIGNSURL:"../dashboard/",YOUTUBEURLVALIDATION:"(http(?:s?):\\/\\/)?(?:www\\.)?youtu(?:be\\.com\\/(?:watch\\?v=|shorts\\/)|\\.be\\/)([\\w\\-_]*)(&(amp;)?[\\w\\?=]*)?",CLEANURLREGEX:"(^\\w+://(www.)?|(www.))",TIMESPANS:{last7Days:"last7Days",last30Days:"last30Days",last3Months:"last3Months",last6Months:"last6Months",customRange:"customRange"}}})),function(){var e,t=this,n=t.document,s=["Webkit","ms","Moz"],r=n.createElement("div");function i(e){var t,n=e.charAt(0).toUpperCase()+e.slice(1);if(e in r.style)return"";for(t=s.length;t--;)if(s[t]+n in r.style)return s[t];return!1}var a=i("transform"),o={};function l(e,t){t||(t=a),o[t]||(o[t]={});var n=o[t][e];return void 0===n&&(n=o[t][e]=t.length?t+e.charAt(0).toUpperCase()+e.substr(1):e[0].toLowerCase()+e.substr(1)),n}var c={standalone:t.navigator.standalone,retina:t.devicePixelRatio>=1.5},u=t.navigator.userAgent.toLowerCase();c.bot=/bingpreview|bingbot|adidxbot|adsbot-google|googlebot|mediapartners-google|googleweblight|google page speed insights|headlesschrome/gi.test(u);var d,g,m,p=(g=u.match(/(edge|edg)[\s\/:]([\w\d\.]+)/),"unknown"==(m=u.match(/(opera|ie|firefox|chrome|trident|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|(?:rv[\s\/:]|version[\s\/:])([\w\d\.]+)|$)/)||[null,"unknown",0])[1]&&g&&(m=g),"trident"==m[1]?(m[1]="ie",m[4]&&(m[2]=m[4])):"crios"==m[1]&&(m[1]="chrome"),(d=/iemobile|windows phone/i.test(t.navigator.appVersion)?"winphone":u.match(/ip(?:ad|od|hone)/)?"ios":(u.match(/(?:webos|android)/)||u.match(/mac|win|linux|cros/)||["other"])[0])&&"other"!=d||(d=t.navigator.platform,/mac/i.test(d)&&(d="mac"),/win/i.test(d)&&(d="windows")),"win"==d&&(d="windows"),{name:"version"==m[1]?m[3]:m[1],version:parseFloat("opera"==m[1]&&m[4]?m[4]:m[2]),platform:d});if("unknown"!=p.name&&(c[p.name]=!0),c.version=p.version,c.name=p.name,c.platform=p.platform,/edg/.test(c.name)&&(c.name="edge"),"edge"==c.name&&c.version>50&&(c.name="chrome",c[c.name]=!0),"ie"==p.name&&n.documentMode&&(c.version=n.documentMode),"BackCompat"==n.compatMode&&(c.quirks=!0,c.version=1),c[p.platform]=!0,c.windows=c.windows||c.winphone,c.mozilla=c.firefox,c.webkit=c.safari||c.chrome,c.webkit&&"webkitAnimation"in r.style&&(a="Webkit"),c.desktop=!(c.android||c.ios||c.winphone),c.android)c.tablet=!/mobile/i.test(u),c.tablet&&(c.desktop=!1),c.genuineAndroid=!/intel/i.test(t.navigator.platform);else{var h=!1;if("iPad"==t.navigator.platform&&(h=!0),!h&&"iPhone"!=t.navigator.platform)!(h=-1!==u.indexOf("ipad"))&&u.match(/mac/)&&t.navigator.maxTouchPoints&&t.navigator.maxTouchPoints>2&&(h=!0);h&&(c.ios=!0,c.mac=!1,c.platform="ios",c.desktop=!1),c.ios&&(c.tablet=h,r.style.setProperty("-apple-pay-button-style","black"),c.genuineApple="black"==r.style.getPropertyValue("-apple-pay-button-style"))}c.phone=!c.desktop&&!c.tablet,c.device=c.tablet?"tablet":c.phone?"phone":"desktop";var f,y={orientationchange:"onorientationchange"in t,threeD:l("perspective")in n.documentElement.style,touch:"ontouchstart"in t||t.navigator.msMaxTouchPoints>0,transform:!1!==a,animation:!1!==i("animationName"),pointer:!!t.PointerEvent,pointerGestures:!!t.MSGesture,pointerEvents:(f=r.style,"pointerEvents"in f&&(f.pointerEvents="auto",f.pointerEvents="foo","auto"==f.pointerEvents))};c.ie&&c.version<=10&&(y.pointerEvents=!1);var E,S,v="onorientationchange"in t?"orientationchange":"resize",I={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend"};for(e in I)if(void 0!==r.style[e]){E=I[e];break}var C={animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend"};for(e in C)if(void 0!==r.style[e]){S=C[e];break}var w=a.length?"-"+a.toLowerCase()+"-":"";var T={language:function(){return t.navigator.language||t.navigator.userLanguage},timezoneOffSet:function(){return(new Date).getTimezoneOffset()}};function O(){return t.innerHeight||(n.documentElement||n.body).clientHeight||0}function b(){return t.innerWidth||(n.documentElement||n.body).clientWidth||0}function N(){return 90==(b()<O()?0:90)}function A(e,s,r,i){r||(r=n.body),i||(i=n.documentElement);var a=t.getComputedStyle(i),o=t.getComputedStyle(r),l=Math.max(r.offsetHeight,i.offsetHeight,r.clientHeight,i.clientHeight),c=Math.max(r.offsetWidth,i.offsetWidth,r.clientWidth,i.clientWidth);return"hidden"==a.overflowY||"hidden"==o.overflowY||s||(l=Math.max(l,r.scrollHeight,i.scrollHeight)),"hidden"==a.overflowX||"hidden"==o.overflowX||e||(c=Math.max(c,r.scrollWidth,i.scrollWidth)),{width:c,height:l}}function P(){return t.pageYOffset||(n.documentElement||n.body.parentNode||n.body).scrollTop||0}var k,R={top:P,pct:function(){var e=A().height-O();return 0===e?100:Math.floor(P()/e*100)}},D={screen:{width:function(){return Math[N()?"max":"min"](t.screen.width,t.screen.height)},height:function(){return Math[N()?"min":"max"](t.screen.width,t.screen.height)},availWidth:function(){return Math[N()?"max":"min"](t.screen.availWidth,t.screen.availHeight)},availHeight:function(){return Math[N()?"min":"max"](t.screen.availWidth,t.screen.availHeight)}},content:{width:0,height:0},win:{width:b,height:O},doc:{dims:A,width:function(e,t,n){return A(e,!0,t,n).width},height:function(e,t,n){return A(!0,e,t,n).height}}};var M=n.querySelector("meta[name=viewport], meta[id=viewport]");function L(e,t){if(e&&"fixed"==t)return"fixed"==e||~e.indexOf("sticky")}function x(){return D.doc.width(!c.desktop,n.body,n.documentElement)}function U(e){var t=x();return c.phone&&void 0!==e&&(Array.isArray(e)?t=Number(e[N()?1:0]):Number(e)===e&&e>0&&(t=e)),t/D.win.width()}function B(e,t,n){return n||(n=.1),Math.abs(e-t)<=n}var V={screenWidth:D.screen.width,screenHeight:D.screen.height,windowWidth:b,windowHeight:O,minimalScreenDimension:function(){return Math.min(D.screen.width(),D.screen.height())},isAddressBarVisible:function(){return!!(c.phone&&c.ios&&c.safari)&&(!!N()&&!B(x()/D.screen.width()*D.screen.availHeight(),D.win.height(),1))},getDocumentScale:U,getDocumentWidth:x,notScaledMobileContent:function(){return B(D.screen.width(),D.win.width()*U(),1)},isPositionValue:L,getPositionValue:function(e){return L(e,"fixed")?c.desktop&&c.safari?"-webkit-sticky":"fixed":e},systemScrollbarWidth:function(){var e;return void 0!==k||(k=0,y.touch||(n.body.insertAdjacentHTML("beforeend",'<div style="visibility:hidden;overflow-y:scroll;">blaah</div>'),e=n.body.lastElementChild,k=e.offsetWidth-e.clientWidth,e.parentNode.removeChild(e))),k},is:c,has:y,jsVendor:a,otherVendors:function(){var e,t=[];for(e=s.length;e--;)s[e]!=a&&t.push(s[e]);return a.length&&t.push(""),t},cssVendor:w,prefixStyle:l,transitionEnd:E,animationEnd:S,resizeEvent:v,mouseButton:function(e){var t="right",n="middle";if(void 0!==e.buttons&&0!==e.buttons){if(2==e.buttons)return t;if(4==e.buttons)return n}else{if(2==e.button)return t;if(1==e.button)return n;if(c.mac&&17==function(e){return 16==e.which||17==e.which||18==e.which||91==e.which?e.which:(e.ctrlKey?17:e.shiftKey&&16)||e.altKey&&18||e.metaKey&&91||0}(e))return t}return c.mac&&e.ctrlKey?t:"left"},isLandscape:N,scroll:R,user:T,userAgent:function(){return t.navigator.userAgent}};sndefine("browser",(function(){if(D.content.width=D.screen.width(),D.content.height=D.screen.height(),!c.desktop&&M&&M.content){var e=M.content.split(",").filter((function(e){if(~e.indexOf("width"))return 1}))[0];e&&(e=parseInt(e.split("=")[1],10)),e===Number(e)&&(D.content.width=e,D.content.height=D.screen.height()/(D.screen.width()/e))}return V}))}.call(this),sndefine("global",(function(){let e=this.document.getElementById("sleeknote-frame");function t(){return e&&e.contentWindow||this}return new(t().Proxy)({},{get(e,n){let s=t()[n];return"fetch"==n&&(s=s.bind(t())),"FormData"==n&&(s=s.bind(t())),s}})})),function(){var e=function(e){for(var t,n,s=[],r=0,i=e.length;r<i;){if(55296==(63488&(t=e.charCodeAt(r++)))){if(n=e.charCodeAt(r++),55296!=(64512&t)||56320!=(64512&n))throw new RangeError("UTF-16(decode): Illegal UTF-16 sequence");t=((1023&t)<<10)+(1023&n)+65536}s.push(t)}return s},t=function(e){for(var t,n=[],s=0,r=e.length;s<r;){if(55296==(63488&(t=e[s++])))throw new RangeError("UTF-16(encode): Illegal UTF-16 value");t>65535&&(t-=65536,n.push(String.fromCharCode(t>>>10&1023|55296)),t=56320|1023&t),n.push(String.fromCharCode(t))}return n.join("")},n=36,s=2147483647;function r(e,t){return e+22+75*(e<26)-((0!==t)<<5)}function i(e,t,s){var r;for(e=s?Math.floor(e/700):e>>1,e+=Math.floor(e/t),r=0;e>455;r+=n)e=Math.floor(e/35);return Math.floor(r+36*e/(e+38))}function a(e,r){var a,o,l,c,u,d,g,m,p,h,f,y,E,S,v=[],I=[],C=e.length;for(a=128,l=0,c=72,(u=e.lastIndexOf("-"))<0&&(u=0),d=0;d<u;++d){if(r&&(I[v.length]=e.charCodeAt(d)-65<26),e.charCodeAt(d)>=128)throw new RangeError("Illegal input >= 0x80");v.push(e.charCodeAt(d))}for(g=u>0?u+1:0;g<C;){for(m=l,p=1,h=n;;h+=n){if(g>=C)throw RangeError("punycode_bad_input(1)");if((f=(S=e.charCodeAt(g++))-48<10?S-22:S-65<26?S-65:S-97<26?S-97:n)>=n)throw RangeError("punycode_bad_input(2)");if(f>Math.floor((s-l)/p))throw RangeError("punycode_overflow(1)");if(l+=f*p,f<(y=h<=c?1:h>=c+26?26:h-c))break;if(p>Math.floor(s/(n-y)))throw RangeError("punycode_overflow(2)");p*=n-y}if(c=i(l-m,o=v.length+1,0===m),Math.floor(l/o)>s-a)throw RangeError("punycode_overflow(3)");a+=Math.floor(l/o),l%=o,r&&I.splice(l,0,e.charCodeAt(g-1)-65<26),v.splice(l,0,a),l++}if(r)for(l=0,E=v.length;l<E;l++)I[l]&&(v[l]=String.fromCharCode(v[l]).toUpperCase().charCodeAt(0));return t(v)}function o(t,a){var o,l,c,u,d,g,m,p,h,f,y,E;a&&(E=e(t));var S=(t=e(t.toLowerCase())).length;if(a)for(g=0;g<S;g++)E[g]=t[g]!=E[g];var v,I,C=[];for(o=128,l=0,d=72,g=0;g<S;++g)t[g]<128&&C.push(String.fromCharCode(E?(v=t[g],I=E[g],(v-=(v-97<26)<<5)+((!I&&v-65<26)<<5)):t[g]));for(c=u=C.length,u>0&&C.push("-");c<S;){for(m=s,g=0;g<S;++g)(y=t[g])>=o&&y<m&&(m=y);if(m-o>Math.floor((s-l)/(c+1)))throw RangeError("punycode_overflow (1)");for(l+=(m-o)*(c+1),o=m,g=0;g<S;++g){if((y=t[g])<o&&++l>s)return Error("punycode_overflow(2)");if(y==o){for(p=l,h=n;!(p<(f=h<=d?1:h>=d+26?26:h-d));h+=n)C.push(String.fromCharCode(r(f+(p-f)%(n-f),0))),p=Math.floor((p-f)/(n-f));C.push(String.fromCharCode(r(p,a&&E[g]?1:0))),d=i(l,c+1,c==u),l=0,++c}}++l,++o}return C.join("")}var l={encodePuny:function(e){for(var t=e.split("."),n=[],s=0;s<t.length;++s){var r=t[s];n.push(r.match(/[^A-Za-z0-9-]/)?"xn--"+o(r):r)}return n.join(".")},decodePuny:function(e){for(var t=e.split("."),n=[],s=0;s<t.length;++s){var r=t[s];n.push(r.match(/^xn--/)?a(r.slice(4)):r)}return n.join(".")}};sndefine("punycode",(function(){return l}))}.call(this),sndefine("utils",["global"],(function(e){var t,n=this,s=n.document,r={};function i(){return e}if(n.location&&!n.location.origin&&(n.location.origin=n.location.protocol+"//"+n.location.hostname+(n.location.port?":"+n.location.port:"")),s.head||(s.head=s.getElementsByTagName("head")[0]),this.document.body){["querySelectorAll","querySelector","getElementsByClassName","getElementsByTagName"].forEach((function(e){r[e]=function(t,n){try{return function(e,t){if(e)switch(e.nodeType){case 0:return function(){};case 1:return i().Element.prototype[t];case 9:return i().Document.prototype[t];case 11:return i().DocumentFragment.prototype[t]||function(){};default:return console.warn("unknown node type: "+e.nodeType),console.trace(),function(){}}}(t,e).call(t,n)}catch(e){}}}))}t=function(e,t,n,s){return e===e+""&&(e=r.getElementById(e)),function r(i){return e[t+"EventListener"](i,n,!!s),r}},r.JSON={parse:function(){return i().JSON.parse.apply(n,arguments)},stringify:function(){return i().JSON.stringify.apply(n,arguments)}};var a={};function o(e,t){if(e){if(Array.isArray(e)||"function"==typeof e[t])return e;if("item"in e&&"length"in e)return Array.from(e)}}let l=i().Array.prototype.entries;function c(e){let t=o(e,"keys");return t?t.keys():Object.keys(e||a)}function u(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function d(){var e,t,n,s,r,i=arguments.length;for(1==i?("array"==(t=u(arguments[0]))&&(s=[]),"object"==t&&(s={}),r=0):(s=arguments[0],r=1);r<i;r++)if("array"!=(t=u(n=arguments[r]))&&"object"!=t)s=n;else for(e in n)t=u(n[e]),s[e]="array"==t||"object"==t?d(s[e]?s[e]:"array"==t?[]:{},n[e]):n[e];return s}function g(e){return e?e.nodeName?e:s.getElementById(e):null}function m(e,t){return t&&!t.nodeName?(console.warn("QSA second argument must be Element",t),[]):Array.prototype.slice.call(r.querySelectorAll(t||s,e))}["XMLHttpRequest","decodeURIComponent","encodeURIComponent"].forEach((function(e){r[e]=function(){return i()[e].apply(n,arguments)}}),this),["getElementById","createElement","createDocumentFragment"].forEach((function(e){r[e]=function(){return i().document[e].apply(s,arguments)}}),this),r.getComputedStyle=function(e,t){return i().getComputedStyle.call(n,e,t)};var p,h=s.documentElement,f=(p=h.matches||h.matchesSelector||h.webkitMatchesSelector||h.msMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector)?function(e,t){return p.call(e,t)}:function(e,t){for(var n=e.parentNode?r.querySelectorAll(e.parentNode,t):[],s=n.length;s--;)if(n[s]===e)return!0};function y(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function E(e){return e.replace(/^-ms-/,"ms-").replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}))}function S(e,t,n){return Array.prototype.slice.call(e,t,n)}function v(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}function I(e){switch(e.nodeName.toLowerCase()){case"input":switch(e.type){case"checkbox":case"radio":if(e.checked)return e.value;break;case"file":case"reset":break;default:return e.value}break;case"textarea":return e.value;case"select":switch(e.type){case"select-one":return e.value;case"select-multiple":var t,n=0;for(n=0,t=e.options.length;n<t;n++)if(e.options[n].selected)return e.options[n].value}break;default:return e.innerText}}let C=i().Promise;var w=C.allSettled?e=>C.allSettled(e):e=>C.all(e.map((e=>e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e}))))));function T(e,t,n){var s=e;if("string"==u(t)){for(var r=t.split(n||"."),i=0;i<r.length&&void 0!==(s=s[r[i]]);i++);return s}}return d(r,{redirectTwemojiUrl:function(e){if("string"==u(e)&&e.includes("/twemoji.maxcdn.com/")){let t=e.split("/").pop().split(".").shift();e=`https://sleeknotestaticcontent.sleeknote.com/emoji/${t}.svg`}return e},htmlStringIterator:function(e){"string"==typeof e&&(e={html:e});let t=s.createElement("template").content.appendChild(s.createElement("main"));t.innerHTML=e.html;let r=s.createTreeWalker(t,e.filter||n.NodeFilter.SHOW_ELEMENT),i=r.currentNode;return{[window.Symbol.iterator](){return this},next:()=>(i=r.nextNode(),i?{value:i}:(e.html=t.innerHTML,{done:!0}))}},definePropConst:function(e,t){let n=Object.keys(t)[0];return Object.defineProperty(e,n,{value:t[n]})},getDocument:function(e){if(e)return"contentDocument"in e?e.contentDocument:e.contentWindow.document},deepProp:T,allSettled:w,Promise:i().Promise,URL:i().URL,findPropValue:function e(t,n){if(String(n).split(".").length>1)return T(t,n);var s=u(t);if("array"==s||"object"==s)for(var r in t)if("array"==(s=u(t[r]))){if(r==n)return t[r];if(void 0!==(i=e(t[r],n)))return i}else if("object"==s){var i;if(void 0!==(i=e(t[r],n)))return i}else if(r==n&&void 0!==t[r])return t[r]},normalizeFontFamily:function(e){return String(e).split(",")[0].toLowerCase().replace(/['"]+/g,"").replace(/^\s+|\s+$/g,"")},urlFromCSSUrl:function(e){return e&&(e=(e=String(e)).slice(e.indexOf("(")+1,e.indexOf(")")).replace(/"/g,"")).includes(".")?e:""},urlencode:v,entries:function(e){let t=o(e,"entries");return t?l.call(t):Object.entries(e||a)},keys:c,values:function(e){let t=o(e,"values");return t?t.values():Object.values(e||a)},DOMContentLoaded:function(){return new(0,i().Promise)((function e(t){"loading"!=s.readyState?t():n.setTimeout(e,100,t)}))},expireDaysToDate:function(e){var t=new Date;if(e=+e||0)return t.setTime(t.getTime()+864e5*e),t},randomName:function(){var e;do{e=Math.random().toString(36).substring(7)}while(!e.substr(0,1).match(/[a-zA-Z]/));return e},appendToUrl:function(e,t){return e+(t?(~e.indexOf("?")?"&":"?")+t:"")},parseForm:function(e,t,n){"use strict";var s,r,i,a,o={};function l(e,t,n){o[e]=t}if(!e||!e.nodeName||"form"!==e.nodeName.toLowerCase())throw"You must supply a form element";for(s=0,r=e.elements.length;s<r;s++)""===(i=e.elements[s]).name||i.disabled||void 0!==(a=I(i))&&l(i.name,a);Object.keys(t||{}).forEach((function(e){l(e,t[e])}));var c=[];return n?c=o:(c=[],Object.keys(o).forEach((function(e){c.push(v(e)+"="+v(o[e]))}))),c},parseNodeValue:I,keyValueToQueryString:function(e){"use strict";var t=[];return c(e).forEach((function(n){t.push(v(n)+"="+v(e[n]))})),t.join("&")},click:function(e,t){return function(e,t,n){var r;if(e)try{(r=s.createEvent("MouseEvent")).initMouseEvent(n||t.type,!0,!0,t.view,0,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),r.initialTarget=t.target,e.dispatchEvent(r)||r.preventDefault()}catch(e){console.log(e.message)}}(e,t,"click")},getAdvOption:function(e,t,n){for(var s=e.options||[],r=s.length,i=[];r--;)if(s[r].id==t){i=s[r].values||[];break}if(void 0===n)return i;for(r=i.length;r--;)if(i[r].id==n)return i[r].value},typeStr:u,listener:t,gid:g,qsa:m,qs:function(e,t){return m(e,t)[0]},extend:d,contains:function(e){var t=Array.isArray(arguments[1])?arguments[1]:S(arguments,1);return Array.isArray(e)?t.some((function(t){return~e.indexOf(t)})):"object"==u(e)?t.some((function(t){return t in e})):t.some((function(t){return e==t}))},slice:S,removeNode:function(e){e&&(e.nodeName||(e=g(e)),e&&e.parentNode&&e.parentNode.removeChild(e))},eventXY:function(e,t){var n,r;return t||(t=0),e.changedTouches&&e.changedTouches.length>t?(n=e.changedTouches[t].pageX,r=e.changedTouches[t].pageY):e.targetTouches&&e.targetTouches.length>t?(n=e.targetTouches[t].pageX,r=e.targetTouches[t].pageY):e.pageX||e.pageY?(n=e.pageX,r=e.pageY):(e.clientX||e.clientY)&&(n=e.clientX+s.body.scrollLeft+s.documentElement.scrollLeft,r=e.clientY+s.body.scrollTop+s.documentElement.scrollTop),{x:n,y:r}},throttle:function(e,t,s,r,i){function a(){this.lastTime=0,this.timer=0,this.after=this.after.bind(this),this.run=this.run.bind(this),this.a1,this.a2,this.a3}s||(s=n),a.prototype={after:function(){t.call(s,this.a1,this.a2,this.a3,3),this.lastTime=0,this.timer=0},run:function(){var a=+new Date,o=r&&!this.lastTime?1:a-this.lastTime>e?2:0;o&&(i||(t.call(s,this.a1,this.a2,this.a3,o),this.lastTime=a),this.timer&&n.clearTimeout(this.timer),this.timer=n.setTimeout(this.after,1.25*e))},throttle:function(e,t,s){this.a1=e,this.a2=t,this.a3=s,n.setTimeout(this.run,0)}};var o=new a;return o.throttle.bind(o)},applyOptions:function(e){var t,n=Object.prototype.hasOwnProperty;if(e)for(t in e)n.call(e,t)&&(this[t]=e[t])},template:function(e,t){for(var n=Array.isArray(t)?t.map((function(e,t){return t})):Object.keys(t),s=n.length;s--;)e=e.replace(new RegExp("\\{"+n[s]+"\\}","g"),t[n[s]]);return e.replace(/\{\w*\}/g,"")},insertHTML:function(e,t,n){return e&&e.nodeName?(n||(n="beforeend"),"afterbegin"==n?s=e.firstElementChild:"afterend"==n&&(s=e.nextElementSibling),e.insertAdjacentHTML(n,Array.isArray(t)?t.join(""):t),"beforebegin"==n?e.previousElementSibling:"afterbegin"==n?s?s.previousElementSibling:e.lastElementChild:"beforeend"==n?e.lastElementChild:"afterend"==n?s?s.previousElementSibling:e.parentNode.lastElementChild:void 0):null;var s},isNumeric:function(e){return!/^(NaN|-?Infinity)$/.test(+e)},isFunction:function(e){return"function"==u(e)},getHostname:function(e){return function e(t){return void 0===e.link&&(e.link=r.createElement.call(s,"a")),e.link.href=2==t.split("://").length?t:n.location.protocol+"//"+t,String(e.link.host)}(e)},getHashParams:function(e){var t,n=0,s={};if((e=([(e=e+""||(e=r.getElementsByTagName("script"))&&e.item(e.length-1).src).split("#")[1]]+"").split("&"))[0])for(;n<e.length;n++)s[(t=e[n].split("=",2))[0]]=t[1]?r.decodeURIComponent(t[1].replace(/\+/g," ")):void 0;return s},empty:function(e){var t=Object.prototype.hasOwnProperty;if(!e||0===e.length)return!0;var n=u(e);if("array"!=n){if("object"==n){for(var s in e)if(t.call(e,s))return!1;return!0}return!(e+"").match(/\S/)}},matchesSel:f,guid:function(e){var t=e||{prefix:!1,length:8};t.prefix||(t.prefix=!1),t.length||(t.length=8),this.length=t.length,this.timestamp=+new Date;for(var n,s,r=this.timestamp.toString().split("").reverse(),i="",a=0;a<this.length;++a){i+=r[(n=0,s=r.length-1,Math.floor(Math.random()*(s-n+1))+n)]}return t.prefix&&(i=t.prefix+"-"+i),i},guid_string:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},querySelectorClosest:function(e,t){if(e)do{if(f(e,t))break}while(e=e.parentElement);return e},getQueryVarByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(n.location.search||n.location.hash);return t?r.decodeURIComponent(t[1].replace(/\+/g," ")):""},cleanUpReferral:function(e){var t=e,n=(t=(t=(t=(t=t.replace("https://","")).replace("http://","")).replace("www.","")).split("/")[0]).split(".");return t=t.replace("."+n[n.length-1],"")},trim:function(e){return e?(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""},camelCaseToDashSeparated:y,dashSeparatedToCamelCase:E,PascalCaseToDashSeparated:function(e){return y(e).substr(1)},getAppliedStyles:function(e,t={}){const{asCSSVars:n}=t;let s=e.style,r=s.length,i=Object.create(null);for(;r--;){let e=E(s[r]);if(n){i[`--${E(e)}`]=s[e]}else i[e]=s[e]}return i}}),r})),sndefine("location",["utils","punycode"],(function(e,t){var n=this,s=n.document.createElement("a");function r(){var e=Array.isArray(arguments[0])?arguments[0]:arguments;this.set.apply(this,e)}function i(t,n){var s,r,i={};if((t=(t=t.replace(/[?#]/,"")).split("&").filter((function(t){return!e.empty(t)})))[0])for(s=0;s<t.length;s++){r=t[s].split("=",2);try{i[r[0]]=r[1]?n?r[1]:e.decodeURIComponent(r[1].replace(/\+/g," ")):void 0}catch(e){e instanceof URIError&&(console.log("Error decoding query, using encoded one"),i[r[0]]=r[1])}}return i}function a(e,t){return s.href=function(e,t){t||(t="http:"),/^\/\//i.test(e)||(t+="//");/^https?:\/\//i.test(e)||(e=t+e);return e}(e,t),new r(t,s.hostname,s.pathname,s.search,s.hash,s.port).toString()}function o(e,t){s.href=e;var n,i=s.pathname.replace(".aspx","").replace(".html","").replace(".htm","").replace(".php",""),a=r.prototype.queryParams.call(s,!0),o=!s.search&&s.hash,l=[];for(n in a)if(a.hasOwnProperty(n)){if(!(n.indexOf("utm_")&&n.toLowerCase().indexOf("sndebug")&&n.toLowerCase().indexOf("snbranch")&&n.toLowerCase().indexOf("snreset")&&n.toLowerCase().indexOf("snsubscribed")))continue;l.push(n+(void 0===a[n]?"":":"+a[n]))}return l=l.join("&"),e=(e=(e=new r(s.protocol,s.hostname,i,o?"":l,o?l:t?"":s.hash,s.port)).toString().replace(/\/$/g,"")).replace(/:\/\/www\./g,"://")}function l(e,t){if(t&&(l.loc=void 0),!l.loc){var s=e.local===String(e.local)?r.fromString(e.local):n.location;l.loc=new r(["protocol","hostname","pathname","search","hash","port"].map((function(t){var r;return"pathname"==t&&"/"==s[t]?n.location[t]:(r=s[t]||n.location[t],"hostname"==t&&(r=r.replace(/^www\./,"")),"search"==t&&e.custom("ignoreHashInUrlPath")&&s.hash.indexOf("?")>-1&&(r=s.hash.slice(s.hash.indexOf("?"))),r)})))}return l.loc}return r.fromString=function(e){return s.href=t.decodePuny(e),new r(s.protocol,s.hostname,s.pathname,s.search,s.hash,s.port)},r.addProtocolIf=r,r.extractDomain=function(r){return"string"!=e.typeStr(r)||e.empty(r)?"":(r=t.decodePuny(r),s.href=o(a(r,n.location.protocol),!0),s.hostname)},r.prototype={domainMatches:function(e){return e=t.decodePuny(e),s.href=o(a(e,this.protocol),!0),this.hostname==s.hostname},matches:function(e,n){e=o(a(e=t.decodePuny(e),this.protocol),!n).toUpperCase();var s,r=o(this.toString(),!n).toUpperCase();if(~e.indexOf("*")){var i=e.split("*")[0];return s=o(i).toUpperCase(),"/"==i[i.length-1]&&i.split("/").length>4&&(s+="/"),0===r.indexOf(s)||0===(r+"/").indexOf(s)}return r==e},contains:function(e){return null!=e&&!1!==e&&o(this.toString(),!0).toUpperCase().indexOf(String(e).toUpperCase())>-1},queryParams:function(e){return i(!this.search&&this.hash?this.hash:this.search,e)},toString:function(){return this.href},set:function(e,t,n,s,r,i){e||(e="http:"),r=r?("#"==r.charAt(0)?"":"#")+r:"",s=s?("?"==s.charAt(0)?"":"?")+s:"",i||(i=""),n||(n=""),n&&"/"!=n.charAt(0)&&(n="/"+n),80!=i&&443!=i||(i="");var a=e+"//"+(t=(t||"").split(":")[0])+(i?":"+i:"");return this.hash=r,this.search=s,this.port=i||"",this.origin=a,this.protocol=e,this.href=a+n+s+r,this.hostname=t,this.pathname=n,this.host=t,this}},r.get=l,r.reset=function(e){return l(e,!0)},r})),sndefine("logger",["core-sleeknote","constants"],(function(e,t){const n=this;function s(...e){try{throw new Error("debug")}catch(n){var t=n.stack.split("\n").slice(2,3).join("").split(":").slice(2,3).join("");return e.push("line:",t),e.join(" ")}}function r(e,t,n){return"string"==typeof e&&(e=e.split("-")[0]),n===Boolean(n)&&(n=n?"YES":"NO"),0===(t+"").indexOf("START")&&(e="\n"+e),void 0!==n&&(t+=": "+n),e+" "+t}function i(e,t,n,s,r){e.CampaignId;var i=(e.CampaignId+"").split("-")[0];r===Boolean(r)&&(r=r?"YES":"NO");var a=[i," ",t||""," [",n||"",', "',s||"",'"]'];void 0!==r&&a.push(" ->");r=void 0===r?"":r;return a.join("")+r}return{log:function(a,o=(e=>e)){const l=t.CORE.FORMATTERS,c={[l.EVALUATOR]:i,[l.CORE]:s,[l.CONFIG]:r};if(e.debug==a){if(c[o])return o=c[o],(...e)=>{console.log(o(...e))};if(o==l.SNDEBUG)return(...e)=>function({type:e,msgs:t=[],styles:s=[]}){if(n.location.search.includes("sleeknote_logs_to_var"))return n.logs||(n.logs=""),n.logs+=t.join(""),void(n.logs+="\n");s=s.map((e=>{switch(e){case"error":return"font-weight: bold; color: rgb(221, 48, 82)";case"normal":return"color: rgb(37, 52, 90)";case"normal-bold":return"color: rgb(37, 52, 90);font-weight: bold;";case"success":return"font-weight: bold; color: rgb(11, 121, 93)";case"message":return"color: rgb(84, 87, 255);font-weight: bold;";case"group":return"font-weight: bold;color: rgb(38, 39, 115);";case"italic":return"font-style: italic;";default:return e}}));let r="";t.forEach((e=>{r+=`%c${e}`}));let i=[r,...s];switch(e){case"group":console.group(...i);break;case"groupCollapsed":console.groupCollapsed(...i);break;case"groupEnd":console.groupEnd();break;default:console.log(...i)}}(...e)}return a==t.CORE.LOGLEVELS.EDITORTARGETING?(n.targetingEditorLog="",e=>{n.targetingEditorLog+=`${e.msgs[0]}<br/>`}):()=>{}}}})),sndefine("consent",["utils"],(function(e){var t=this,n={},s={};const r="SleekNote";function i(t,n){return n==r?e.dashSeparatedToCamelCase("sleeknote-"+t+"-consent"):`${n}.consent.${t}`}function a(e,r,a,o){let l=r in n?r[n]:function(e){for(let n of t.sndefine.namespaces){let r=i(e,n);if(r in t)return s[e]=!!t[r]}}(r),c=i(r,e),u=Object.getOwnPropertyDescriptor(t,c);if(!u||!u.set){void 0===l?(l=a(r,!0),n[r]=void 0===l||!!l):(n[r]=l,o(n[r],r,a));const e=function(e){e=!!e,n[r]!=e&&(n[r]=e,o(n[r],r,a))};Object.defineProperty(t,c,{set:e,get:function(){var t=new Boolean(!!n[r]);return t.set=e,t}})}}return{get:function(e){return n[e]},initialize:function(e,n,s){for(let r of t.sndefine.namespaces)a(r,e,n,s);t.sndefine.namespaces.has(r)||a(r,e,n,s)}}})),sndefine("cookie",["utils"],(function(e){var t=this.document;return{hasItem(n){if(n)return new RegExp("(?:^|;\\s*)"+e.encodeURIComponent(n).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(t.cookie)},keys:()=>t.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/).map((t=>e.decodeURIComponent(t))),getItem(n,s){return n&&function(t,n){return n?t:e.decodeURIComponent(t)}(t.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+(r=n,i=s,i?r:e.encodeURIComponent(r)).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"),s)||null;var r,i},setItem(n,s,r,i,a,o,l){let c="";if(n&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(n)){if(r)switch(r.constructor){case Number:c=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:c="; expires="+r;break;case Date:c="; expires="+r.toUTCString()}return t.cookie=(l?n:e.encodeURIComponent(n))+"="+(l?s:e.encodeURIComponent(s))+c+(a?"; domain="+a:"")+(i?"; path="+i:"")+(o?"; secure":"")+"; SameSite=Lax",!0}},removeItem(n,s,r){return!!this.hasItem(n)&&(t.cookie=e.encodeURIComponent(n)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(r?"; domain="+r:"")+(s?"; path="+s:""),!0)}}})),sndefine("targeting-evaluator",["logger","constants","utils","global"],(function(e,t,n,s){const r=this,{MATCHES:i,CONTAINS:a}=t.TARGETING.TYPES,{SHOW:o,HIDE:l}=t.TARGETING.VISIBILITY,{AND:c}=t.TARGETING.RELATIONS,u=[i,a],d={AND:"every",OR:"some"};function g(e){try{const t=e.includes("http")?e:`https://${e}`;return new s.URL(t)}catch(e){console.error(e)}}return{[i](e,t,s,i){const a=i||r.location;function o(e){return"/"==e[e.length-1]?e.substring(0,e.length-1):e}function l(e){return"www."==e.substring(0,4)?e.substring(4,e.length):e}return n.keys(e).some((e=>{this.log({msgs:[`       ${e} ...`],styles:["normal"]});const t=g(e),n=["hostname","pathname","search","hash"].every((e=>{let n=a[e],s=t[e];if(("search"==e||"hash"==e)&&!s)return!0;if("hostname"==e&&(n=l(n),s=l(s)),"pathname"==e&&(s=o(s),n=o(n),s.includes("*"))){let[t,r]=s.split("*");t=o(t);const i=!t||o(n.substring(0,t.length)).toUpperCase()==t.toUpperCase(),a=!r||n.substring(n.length-r.length,n.length).toUpperCase()==r.toUpperCase();return i&&a?this.log({msgs:[`            "${s}" matches current url ${e}(${n})`],styles:["normal"]}):this.log({msgs:[`            "${s}" doesn't match current url ${e}(${n})`],styles:["normal"]}),i&&a}if(s.includes("*")){let e=s.split("*")[0];s=s.substr(0,e.length),n=n.substr(0,e.length)}return s.toUpperCase()==n.toUpperCase()?(this.log({msgs:[`            "${s}" matches current url ${e}(${n})`],styles:["normal"]}),!0):(this.log({msgs:[`            "${s}" doesn't match current url ${e}(${n})`],styles:["normal"]}),!1)}));return n||this.log({msgs:[`            "${e}" doesn't match current url(${a.href})`],styles:["normal"]}),n}))},[a](e,t,s,i){const a=i||r.location,o=d[t];return n.keys(e)[o]((e=>{this.log({msgs:[`       ${e} ...`],styles:["normal"]});const t=["hostname","pathname","search","hash"].some((t=>!!a[t].toUpperCase().includes(e.toUpperCase())&&(this.log({msgs:[`            "${e}" found in ${t}`],styles:["normal"]}),!0)));return t||this.log({msgs:[`          "${e}" not found in this URL`],styles:["normal"]}),t}))},proccessTree(e,t,s){if(u.includes(e.type)){this.log({msgs:[`   ${e.type.toUpperCase()} ${e.relationOperator==c?"all of":"one of"}:`],styles:["normal"]});const n=this[e.type](e.values,e.relationOperator,t,s);return this.log({msgs:[`   ${e.type.toUpperCase()} with ${e.relationOperator} relation evaluated to: ${n}`],styles:["normal"]}),n}if(!n.empty(e.children)){"Root"!=e.id&&this.log({msgs:[` ${e.visibility==o?"SHOW":"HIDE"} if URL...`],styles:["normal"]});const r=d[e.relationOperator];let i=n.keys(e.children)[r]((n=>this.proccessTree(e.children[n],t,s)));return i=e.visibility==l?!i:i,"Root"!=e.id&&this.log({msgs:[` group ${e.visibility==o?"SHOW":"HIDE"} evaluated to ${i?"SHOW":"HIDE"}`],styles:["normal"]}),i}},evaluate:function(n){this.log=e.log(t.CORE.LOGLEVELS.CS,t.CORE.FORMATTERS.SNDEBUG);var s=(n.CampaignId+"").split("-")[0];return!!n.targeting.targetAll||this.proccessTree(n.targeting.root,s)},editorEvaluate:function(n,s){this.log=e.log(t.CORE.LOGLEVELS.EDITORTARGETING);const r=g(n),i=this.proccessTree(s.root,"",r);return this.log({msgs:["TARGETING EVALUATED TO "+(i?"SHOW":"HIDE")]}),i}}})),sndefine("event-emitter",["utils","global","core-sleeknote","constants"],(function(e,t,n,s){var r=this,i=r.document;let a=s.CORE.EVENTS,o=s.CORE.COMMANDS;function l(e){let t="sleekNote";return"SleekNote"!=e&&(t=e),t}function c(e){let t=l(e),n=i.createEvent("Event");return n.initEvent(t,!0,!0),n}function u(s,l){return new t.Promise((function(t,u){try{r.requestAnimationFrame((function(){var r=i.createEvent("Event");if(r.initEvent(n.eventName,!0,!0),r.data=function(t,s){switch(t){case a.LOAD:return{type:t,command:s.command,NS:s.NS,coreConfig:n};case a.READY:let r=s,i={},o={};for(let[t,n]of e.entries(r.notes))o[t]={name:t,DOMNode:n.config.DOMNode},i[t]=n.config.DOMNode;return{type:t,campaignId:r.config.campaignId,NS:r.config.NS,boxes:o,DOMNodes:i};default:if(!s)return{command:t,type:t};let l=s.origin&&s.origin.config||s.campaign&&s.campaign.config;return{...s,command:t,type:s.type||t,campaignId:l&&l.campaignId||s.campaignId,NS:s.NS||l&&l.NS}}}(s,l),r.detail=r.data,i.dispatchEvent(r),r.data.result&&r.data.result.then?r.data.result.then(t,u):t(),"visible"==s)["opened","closed"].map((function(t){for(let n of e.values(l[t])){let e=c(n.campaign.config.NS);e.data={type:"opened"==t?a.ENTRY:a.EXIT,campaignId:n.campaign.config.campaignId,box:{name:n.noteName},origin:n.campaign.notes[n.noteName],noteName:n.noteName,NS:n.campaign.config.NS},n.noteName&&(e.data.box.DOMNode=n.campaign.notes[n.noteName].config.DOMNode),i.dispatchEvent(e)}}));else if(r.data.NS){let e=c(r.data.NS);s==a.LOAD||s==a.READY?e.data=r.data:s==o.CLICK?e.data={type:a.CLICK,campaignId:l.campaignId,DOMNode:l.eventTarget,noteName:l.name,href:l.href,action:l.step}:s==o.SUBMIT&&(e.data={type:a.SUBMIT,campaignId:l.campaignId,data:l.formData}),e.data&&i.dispatchEvent(e)}}))}catch(e){u()}}))}return e.definePropConst(u,{createUserEventName:l}),u})),sndefine("storage-categories",["consent","utils","core-sleeknote"],(function(e,t,n){let s={timestamp:"sn_global_countdown_last_reset_timestamp",_sn_a:"_sn_a",_sn_m:"_sn_m",_sn_n:"_sn_n",location:"location",mergeId:"mergeId",cookie:"cookie",session:"session",siteData:"siteData",local:"local",analytics:"analytics",marketing:"marketing",SNSubscribed:"SNSubscribed",SNS:"SNS",necessary:"necessary",SleekNote:"SleekNote"},{timestamp:r,_sn_a:i,_sn_m:a,_sn_n:o,location:l,cookie:c,session:u,siteData:d,local:g,analytics:m,marketing:p,SNSubscribed:h,SNS:f,necessary:y,SleekNote:E,mergeId:S}=s,v={[m]:["visitorId","goalShown","goalEngaged","userSessionStart","userSessionEnd",l],[y]:["globalCountdown","sessionId","campaignClosed","campaignHidden","sessionConverted","campaignEngaged","queryIncluded","showCount","sessionShowCount","inSplitTest","splitTestCohort","consent","mergeId"],[p]:["referrer","UTMInclude","sequence","pagesVistedTotal","pageVisitedSession","newVisitor","geoLocation","IPAddress"]},I=n.custom("necessaryNotInCookie");let C={cookie:{[i]:{default:{},type:c},[a]:{default:{},type:c},[o]:{default:{},type:c},[f]:{type:c},[h]:{type:c}},local:{[E]:{default:{},type:g},[r]:{type:g}},session:{[E]:{default:{},type:u}}},w={[m]:v[m],[p]:v[p],[d]:[d]};return{isAllowed:function(s){if(n.preview)return!1;if(s==d)return e.get(s);for(let[n,r]of t.entries(w))if(r.includes(s))return e.get(n);return!0},overAllKeys:async function(e,n,s,r){for(let[i,a]of t.entries(C))for(let t of Object.keys(a)){let a=await e[i][n](t);s&&s.call(r,a,i,t)}},getStorage:function(e){let n=function(e){if(t.contains(e,d))return u;let n=[S,"timestamp"];return I&&n.push("globalCountdown","sessionId","campaignClosed","campaignHidden","sessionConverted","campaignEngaged","queryIncluded","showCount","sessionShowCount","inSplitTest","splitTestCohort"),t.contains(e,n)?g:c}(e),s=e;return n==c?s=function(e){for(let[n,s]of t.entries(v))if(s.includes(e))return"_sn_"+n.charAt(0);return e}(e):n==u?s=E:n==g&&(s="timestamp"==s?r:E),{type:n,key:s}},props:s,storageKeys:C,getStorageForErase:function(e){return{[m]:[[c,i]],[p]:[[c,a]],[d]:[[u,E]]}[e].map((e=>({type:e[0],key:e[1]})))}}})),sndefine("storage-base",["utils","storage-categories"],(function(e,t){function n(t){for(let s in t)"object"==typeof t[s]?(n(t[s]),e.empty(t[s])&&delete t[s]):null!=t[s]&&""!==t[s]||delete t[s];return e.empty(t)?void 0:t}return class{constructor(e){this.cache=Object.create(null)}has(e){return e in this.cache}async write(s,r,i){this.cache[r]=e.extend(i),void 0===(i=n(this.cache[r]))?await this.erase(r):t.isAllowed(s)&&await this.writeData(r,i)}async writeData(e){}async read(n){let s=t.storageKeys[this.type][n].default,r=await this.readData(n);return this.cache[n]=e.extend(void 0===r?s:r),this.cache[n]}async readData(e){}async erase(e){let n=t.storageKeys[this.type][e].default;void 0===n?delete this.cache[e]:this.cache[e]=n,await this.eraseData(e)}async eraseData(e){}}})),sndefine("storage-cookie",["utils","cookie","storage-base","core-sleeknote"],(function(e,t,n,s){return class extends n{constructor(t){super(t),this.cookiePath=s.custom("cookiePath","/"),this.cookieDomain=void 0,this.cookieSecure=!1,this.days=365,this.noCookieEncoding=!0,this.type="cookie",e.applyOptions.call(this,t)}setCookie(n,s,r,i){return t.setItem(n,s,e.expireDaysToDate(r),this.cookiePath,this.cookieDomain,this.cookieSecure,i)}removeCookie(e){return t.removeItem(e,this.cookiePath,this.cookieDomain)}readCookie(e,n){return t.getItem(e,n)}async writeData(t,n){this.setCookie(t,e.JSON.stringify(n),this.days,this.noCookieEncoding)}async readData(n){let s;try{null!==t.getItem(n)&&(s=e.JSON.parse(t.getItem(n)))}catch(e){}return s}async eraseData(e){this.removeCookie(e)}}})),sndefine("storage-local",["utils","storage-base","global"],(function(e,t,n){var s=this;return class extends t{constructor(e){super(e),this.type=e.name||"local",this.name=this.type+"Storage",function(e){try{return s[e].setItem("test","1"),s[e].removeItem("test"),e in s&&null!==s[e]}catch(e){}}(this.name)||(this.dummyStorage=!0)}async readData(t){if(!this.dummyStorage){let n;try{n=e.JSON.parse(s[this.name].getItem(t))}catch(e){}return null===n?void 0:n}}async writeData(t,r){return!!this.dummyStorage||new n.Promise((n=>{s.requestAnimationFrame((()=>{s[this.name].setItem(t,e.JSON.stringify(r)),n()}))}))}async eraseData(e){this.dummyStorage||s[this.name].removeItem(e)}}})),sndefine("storage-cookie-session",["utils","storage-cookie"],(function(e,t){var n="SNS";return class extends t{constructor(){super(),this.set=!!this.readCookie(n,!0),this.set||this.setCookie(n,1,"",!0)}unset(){this.set=!1,this.removeCookie(n)}}})),sndefine("storage-instance",["utils","storage-cookie-session","constants","core-sleeknote","location","storage-cookie","storage-local","storage-categories","consent","event-emitter","global"],(function(e,t,n,s,r,i,a,o,l,c,u){var d=this.document;function g(e){return String(e).substring(0,4)}let m=new class{constructor(){this.providers={session:new a({name:"session"}),local:new a({name:"local"}),cookie:new i},d.addEventListener(s.eventName,this)}handleEvent(t){let r=n.CORE.COMMANDS,{command:i,campaignId:a,origin:o,name:l}=t.data;if(i==r.OPEN){let e=o.campaign;if(e.first("form")==l){if(this.incrementShowCount(a),e.config.position==n.POS.EMBEDDED)return;this.closeSession(a),n.PROFILE.MOBILE!=e.config.profile||e.isHello||this.hideSession(a)}}else if(i==r.CLOSE){if(o.campaign.config.position==n.POS.EMBEDDED)return;let t=o.config.type;e.contains(t,"teaser","form")&&this.hideSession(a)}else if(i==r.SUBMIT){let e,t,r=o.campaign,i=!0;switch(r.config.type){case"social":break;case"newsletter":e=!0,t=!0;break;case"contact":case"blank":case"promote":case"guide":t=!0}if(i&&this.setShowCount(a,999999),t&&this.setEngaged(a),r.config.position==n.POS.EMBEDDED&&!s.custom("embeddedSetSubscription"))return;if(e&&this.setSubscription(),r.config.position==n.POS.EMBEDDED)return;this.hideSession(a)}}async postCreate(){await o.overAllKeys(this.providers,"read");let i=o.props._sn_n,a=this.providers.cookie,u=this;function g(e,t){l.initialize(e,(function(e,n){let s=a.cache[i];return n?s[t]:s}),(function(e,n,s){let r=s(n);e?delete r[t]:(r[t]=e,u.erase(n)),a.write("consent",i,r)}))}g.bind(this,"analytics","ca").call(),g.bind(this,"marketing","cm").call(),g.bind(this,"siteData","csd").call(),this.resetMemData(),(new t).set||(await this.resetSessionData(),this.setNewVisitor(this.newVisitorCheck())),void 0===this.getNewVisitor()&&this.setNewVisitor(!1),this.newVisitor=this.getNewVisitor();let m=e.cleanUpReferral(d.referrer);!this.getReferral()&&m.indexOf(r.get(s).host)<0&&this.setReferral(m),s.isSubscribedFromQuery&&this.setSubscription(),c(n.CORE.EVENTS.STORAGE,{ready:"ready"})}async clear(){await o.overAllKeys(this.providers,"erase"),await this.postCreate()}read(t){let{type:n,key:s}=o.getStorage(t),r={};return n&&s&&(r=this.providers[n].cache[s]),"object"!=e.typeStr(r)||"cs"in r||(r.cs={}),r}async write(e,t){let{type:n,key:s}=o.getStorage(e);if(n&&s){let r=t;return this.providers[n].write(e,s,r)}}async erase(e){for(let{type:t,key:n}of o.getStorageForErase(e).values())return"cookie"!==t&&n!=o.props.timestamp?this.write(e,void 0):this.providers[t].erase(n)}readByCampaignId(e,t){let n=this.read(e);return n.cs||(n.cs={}),n.cs[g(t)]||{}}async writeByCampaignId(t,n,s){let r=this.read(t);return r.cs||(r.cs={}),e.empty(s)?delete r.cs[g(n)]:r.cs[g(n)]=s,this.write(t,r)}preserveIfNotExpired(e){return e&&e.length>=1?Date.now()<e[0]?e:void 0:e}async resetSessionData(){this.deleteReferral(),this.deleteGoal(),this.deleteGeoInfo(),this.deleteSessionShowCount(),this.resetMemData(),await this.resetCampaignSessionData()}resetMemData(){this.pageVisited={}}async resetCampaignSessionData(){await o.overAllKeys(this.providers,"read",(async function(t,n,s){if(t&&t.cs)for(let[n,s]of e.entries(t.cs))t.cs[n]={i:this.preserveIfNotExpired(s.i),pv:s.pv}}),this)}async forceResetSession(e){var t,n,s;"full"!=e&&(t=this.getGeoInfo(),s=this.getIPAddress(),n=this.getPagesVisitedCount()),o.overAllKeys(this.providers,"erase"),this.setNewVisitor(this.newVisitorCheck()),this.newVisitor=this.getNewVisitor(),t&&this.setGeoInfo(t),n&&this.setPagesVisitedCount(n),s&&this.setIPAddress(s),this.startSessionTime()}async closeSession(e){var t=this.readByCampaignId("campaignClosed",e);return t.c=1,this.writeByCampaignId("campaignClosed",e,t)}async openSession(e){var t=this.readByCampaignId("campaignClosed",e);return delete t.c,this.writeByCampaignId("campaignClosed",e,t)}isSessionClosed(e){return!!(this.readByCampaignId("campaignClosed",e)||{}).c}async hideSession(e){var t=this.readByCampaignId("campaignHidden",e);return t.h=1,this.writeByCampaignId("campaignHidden",e,t)}async unHideSession(e){var t=this.readByCampaignId("campaignHidden",e);return delete t.h,this.writeByCampaignId("campaignHidden",e,t)}isSessionHidden(e){return!!this.readByCampaignId("campaignHidden",e).h}migrateEngaged(e){var t=this.readByCampaignId("campaignEngaged",e);return t.e=1,this.writeByCampaignId("campaignEngaged",e,t)}setEngaged(e){var t=this.readByCampaignId("campaignEngaged",e);t.e=1,this.writeByCampaignId("campaignEngaged",e,t),this.recordGoalEngaged(e)}setUnEngaged(e){let t=this.readByCampaignId("campaignEngaged",e);delete t.e,this.writeByCampaignId("campaignEngaged",e,t),t=this.read("goalEngaged"),t.g&&t.g.e&&(delete t.g.e[e],this.write("goalEngaged",t))}isEngaged(e){return!!this.readByCampaignId("campaignEngaged",e).e}convertSessionEvent(e){var t=this.readByCampaignId("sessionConverted",e);return t.z=1,this.writeByCampaignId("sessionConverted",e,t)}hasConvertSessionEvent(e){return!!this.readByCampaignId("sessionConverted",e).z}setUTMInclude(e,t){var n=this.readByCampaignId("UTMInclude",e);return n.u=t,this.writeByCampaignId("UTMInclude",e,n)}getUTMInclude(e){return this.readByCampaignId("UTMInclude",e).u}setQueryInclude(e,t){var n=this.readByCampaignId("queryIncluded",e);return n.q=t,this.writeByCampaignId("queryIncluded",e,n)}getQueryInclude(e){return this.readByCampaignId("queryIncluded",e).q}getSequence(t){var n,s=this.readByCampaignId("sequence",t);return n=s.s,Array.isArray(n)&&n.forEach((function(t,n,s){s[n]=e.decodeURIComponent(t)})),n||[]}setSequence(t,n){var s,r=this.readByCampaignId("sequence",t);return e.empty(n)?delete r.s:r.s=(s=n,Array.isArray(s)&&s.forEach((function(t,n,s){s[n]=e.encodeURIComponent(t)})),s),this.writeByCampaignId("sequence",t,r)}getPagesVisitedCountPerSession(e){return this.readByCampaignId("pageVisitedSession",e).pvs}setPagesVisitedCountPerSession(t,n){var s=this.readByCampaignId("pageVisitedSession",t);return e.empty(n)?delete s.pvs:s.pvs=n,this.writeByCampaignId("pageVisitedSession",t,s)}getPagesVisitedCount(e){return(this.readByCampaignId("pagesVistedTotal",e)||{}).pv}setPagesVisitedCount(t,n){var s=this.readByCampaignId("pagesVistedTotal",t);return e.empty(n)?delete s.pv:s.pv=n,this.writeByCampaignId("pagesVistedTotal",t,s)}getPagesVisitedCountSetted(e){return this.pageVisited[e]&&this.pageVisited[e].spv}setPagesVisitedCountSetted(e,t){this.pageVisited[e]={spv:t}}getPagesVisitedCountPerSessionSetted(e){return this.pageVisited[e]&&this.pageVisited[e].spvs}setPagesVisitedCountPerSessionSetted(e,t){this.pageVisited[e]={spvs:t}}setSubscription(){return this.providers.cookie.write("sns","SNSubscribed",!0)}eraseSubscription(){return this.providers.cookie.write("sns","SNSubscribed",!1)}isSubscribed(){return this.providers.cookie.read("SNSubscribed",!1)}migrateShowCount(e,t,n){var s=this.readByCampaignId("showCount",e);s.i=[n,t],this.writeByCampaignId("showCount",e,s)}setShowCount(t,n,s){s=+s||365;var r=this.readByCampaignId("showCount",t);return r.i=[e.expireDaysToDate(s).getTime(),n],this.writeByCampaignId("showCount",t,r)}getShowCount(e){var t=this.readByCampaignId("showCount",e);return t.i=t.i||[],t.i[1]||0}incrementShowCount(e){this.setShowCount(e,this.getShowCount(e)+1),this.incrementSessionShowCount(),this.recordGoalShown(e)}eraseShowCount(e){var t=this.readByCampaignId("showCount",e);return delete t.i,this.writeByCampaignId("showCount",e,t)}cleanShowCount(e){this.getShowCount(e)<1&&this.eraseShowCount(e)}deleteSessionShowCount(){var e=this.read("sessionShowCount");return delete e.ssc,this.write("sessionShowCount",e)}setSessionShowCount(e){var t=this.read("sessionShowCount");return t.ssc=e,this.write("sessionShowCount",t)}getSessionShowCount(){return+this.read("sessionShowCount").ssc||0}incrementSessionShowCount(){return this.setSessionShowCount(this.getSessionShowCount()+1)}deleteReferral(e){var t=this.read("referrer");if(t.r)return delete t.r.r,this.write("referrer",t)}setReferral(e){var t=this.read("referrer");return t.r=t.r||{},t.r.r=e,this.write("referrer",t)}getReferral(){var e=this.read("referrer");return e.r=e.r||{},e.r.r||""}newVisitorCheck(){return void 0===this.getNewVisitor()}setNewVisitorIf(e){e&&this.setNewVisitor(!0)}setNewVisitor(e){var t=this.read("newVisitor");return t.r=t.r||{},t.r.n=+e,this.write("newVisitor",t)}getNewVisitor(){var e=this.read("newVisitor");return e.r=e.r||{},e.r.n}setVistorIdIf(e){var t=this.read("visitorId");if(t)return t.v=t.v?t.v:e,this.write("visitorId",t),t.v}getVistorId(){var t=this.read("visitorId");return t.v||(t.v=e.guid_string(),this.write("visitorId",t)),t.v}hasVisitorId(){return!e.empty(this.read("visitorId").v)}deleteGeoInfo(e){var t=this.read("geoLocation");return delete t.gi,this.write("geoLocation",t)}async setGeoInfo(e){var t=this.read("geoLocation");return t.gi=e,this.write("geoLocation",t)}getGeoInfo(){return this.read("geoLocation").gi}async fetchGeoInfo(){let t=this.getGeoInfo();if(e.empty(t)){if(t=await u.fetch("https://geolocation.sleeknote.com").then((e=>e.text())).then((e=>{let t=JSON.parse(e);if(t.countryCode)return{lt:t.latitude,lg:t.longitude,latitude:t.latitude,longitude:t.longitude,country:t.countryName,countryCode:t.countryCode,regionCode:t.regionCode,regionName:t.regionName}})).catch((e=>{console.log(e)})),e.empty(t))return!1;await this.setGeoInfo(t)}return t}setIPAddress(e){var t=this.read("IPAddress");return t.ip=e,this.write("IPAddress",t),t.ip}getIPAddress(){return this.read("IPAddress").ip}deleteGoal(){var e=this.read("goalShown");return delete e.g,this.write("goalShown",e)}migrateGoalShown(e,t){var n=this.read("goalShown");return n.g=n.g?n.g:{},n.g.sc=n.g.sc?n.g.sc:{},n.g.sc[e]=t,this.write("goalShown",n)}recordGoalShown(e){var t=this.read("goalShown");return t.g=t.g?t.g:{},t.g.sc=t.g.sc?t.g.sc:{},t.g.sc[e]=(t.g.sc[e]?t.g.sc[e]:0)+1,this.write("goalShown",t),t.g.sc[e]}getGoalShownList(){var e=this.read("goalShown");return e.g=e.g?e.g:{},e.g.sc||{}}recordGoalEngaged(e){var t=this.read("goalEngaged");return t.g=t.g?t.g:{},t.g.e=t.g.e?t.g.e:{},t.g.e[e]=1,this.write("goalEngaged",t),t.g.e[e]}getGoalEngageList(){var e=this.read("goalEngaged");return e.g=e.g?e.g:{},e.g.e||{}}resetGoal(){var e=this.read("goalEngaged");return delete e.g,this.write("goalEngaged",e)}migrateStartSessionTime(e){var t=this.read("userSessionStart");t.a=t.a||{},t.a.s=e,this.write("userSessionStart",t)}startSessionTime(){var e=this.read("userSessionStart");e.a=e.a||{},e.a.s=(new Date).getTime(),this.write("userSessionStart",e),this.resetSessionId()}getSessionStartTime(){var e=this.read("userSessionStart");return e.a=e.a||{},e.a.s||(e.a.s=(new Date).getTime(),this.write("userSessionStart",e)),new Date(e.a.s)}migrateEndSessionTime(e){var t=this.read("userSessionEnd");return t.a=t.a||{},t.a.e=e,this.write("userSessionEnd",t)}endSessionTime(){var e=this.read("userSessionEnd");e.a=e.a||{},e.a.e=(new Date).getTime(),this.write("userSessionEnd",e),this.deleteSessionId()}getLastSessionEndTime(){var e=this.read("userSessionEnd");return e.a=e.a||{},e.a.e?new Date(e.a.e):""}migrateSessionId(e){var t=this.read("sessionId");t.a=t.a||{},t.a.i=e,this.write("sessionId",t)}deleteSessionId(){var e=this.read("sessionId");return e.a=e.a||{},delete e.a.i,this.write("sessionId",e)}resetSessionId(){var t=this.read("sessionId");return t.a=t.a||{},t.a.i=e.guid_string(),this.write("sessionId",t),t.a.i}getSessionId(){var t=this.read("sessionId");return t.a=t.a||{},t.a.i||(t.a.i=e.guid_string(),this.write("sessionId",t)),t.a.i}setInTest(e,t){var n=this.readByCampaignId("inSplitTest",e);n.t=n.t||{},n.t.i=t,this.writeByCampaignId("inSplitTest",e,n)}getInTest(e){var t=this.readByCampaignId("inSplitTest",e);return t.t=t.t||{},t.t.i||null}setChosenCohort(e,t){var n=this.readByCampaignId("splitTestCohort",e);return n.t=n.t||{},n.t.c=t,this.writeByCampaignId("splitTestCohort",e,n)}getChosenCohort(e){var t=this.readByCampaignId("splitTestCohort",e);return t.t=t.t||{},t.t.c||null}setMergeId(e,t){var n=this.read("mergeId")||{};return n.mergeId=n.mergeId||{},n.mergeId[e]=t,this.write("mergeId",n)}getMergeId(e){var t=this.read("mergeId")||{};return t.mergeId=t.mergeId||{},t.mergeId[e]||-1}brandNewDay(e){this.eraseShowCount(e),this.unHideSession(e),this.openSession(e),this.setUnEngaged(e),this.eraseSubscription()}report(t){let n="getNewVisitor,getSessionShowCount,getReferral,getGoalShownList,getGoalEngageList,getSessionStartTime,getLastSessionEndTime,getSessionId,isSubscribed".split(",").map((n=>{let s=this[n]();if(!e.empty(s)||t)return[n,s]})).filter((e=>e));return Object.fromEntries(n)}reportCampaign(t,n){let s="getUTMInclude,getQueryInclude,getSequence,getPagesVisitedCountPerSession,getPagesVisitedCount,getPagesVisitedCountSetted,getPagesVisitedCountPerSessionSetted,getShowCount,getInTest,getChosenCohort,getMergeId,hasConvertSessionEvent,isEngaged,isSessionHidden,isSessionClosed".split(",").map((s=>{let r=this[s](t);if((!e.empty(r)||n)&&-1!==r)return[s,r]})).filter((e=>e));return Object.fromEntries(s)}};return s.expose(m,"storage"),m})),sndefine("site-data",["utils","storage-instance","event-emitter","constants","core-sleeknote","global"],(function(e,t,n,s,r,i){let a=this;let o=new i.Map,l=r.custom("splitSiteData",!1);const c="SleekNote";function u(e){return e==c?"sleeknote":e}function d(e){let t="sleeknoteSiteData";return e!=c&&(t=e+".sitedata"),t}function g(){return t.read("siteData")||{}}function m(e){let t=g();return l?(t[e]||(t[e]={}),t[e]):t}function p(r,i,a){let o,c=m(i);for(let[t,n]of e.entries(r))c[t]!=n&&(c[t]=n,o=!0);if(o){let e=g();l&&(e[i]=c),t.write("siteData",e),a||n(s.CORE.EVENTS.SITEDATA,{NS:i,sessionData:c})}return o}function h(e,t,n){return"answer"==t?{question:n.attrs.question,answer:e}:e}const f=i.Symbol("NS");function y(e,t){return e[t]||(e[t]={id:t,formFields:{}})}function E(e){let t=u(e),n=function(e){let t=d(e);return a[t]||(a[t]={}),a[t]}(e);return n[t]||(n[t]={})}function S(t,n,s){if(s){let r=E(t),i=y(r,n);e.extend(i,s)}}return a.document.addEventListener(r.eventName,(function(t){if(t.data.command==s.CORE.COMMANDS.SUBMIT){let{formData:n,formElements:s,NS:r}=t.data,i=n.SleeknoteId;if(!s)return;let a={};for(let[t,r]of e.entries(s))t in n&&(a[t]=h(n[t],t,r));let o=y(E(r),i);e.extend(o.formFields,a),S(r,i,o)}})),{initialize:function(e){for(let t of e){if(o.has(t))return;let e=d(t),n=u(t);if(Array.isArray(a[e]))for(let n of a[e])p(n,t,!0);class s extends i.Object{constructor(e){super(),i.Object.defineProperty(this,f,{value:e}),i.Object.defineProperty(this,n,{writable:!0,value:{}})}push(e){p(e,this[f])}}a[e]=i.Object.seal(new s(t)),o.set(t,a[e])}},getSession:m,getSitedataObject:function(e){if(e){let t=d(e);return a[t]}},saveToSitedataOwnData:S,readFromSitedataOwnData:function(e,t){let n=E(e);return y(n,t)},getSubmitted:function(e){let t=u(e.NS),n=d(e.NS);return(a[n]&&a[n][t]||{})[e.campaignId]}}})),sndefine("evaluator",["utils","location","core-sleeknote","site-data","constants","cookie","storage-instance","logger","targeting-evaluator","global"],(function(e,t,n,s,r,i,a,o,l,c){var u=this;const d=o.log(r.CORE.LOGLEVELS.CS,r.CORE.FORMATTERS.SNDEBUG);function g(e,t){return async function(t,n,s,r,i){d({msgs:[`- ${e.name}`],type:"groupCollapsed",styles:["group"]});var a=await E(e,"exclude",s.exclude,r,i);return a?a=await E(e,"include",s.include,r,i):t||"exclude",d({type:"groupEnd"}),d(a?{msgs:[`  ${e.name} passed`],styles:["success"]}:{msgs:[`  ${e.name} didn't pass`],styles:["error"]}),a}}function m(e,s,r){return C(e,t.get(n).matches(s))}function p(e,s,r){return C(e,t.get(n).contains(s))}async function h(e,t,n){let s=await a.fetchGeoInfo(t.addressComponents);let r;if((t=t||{}).sw)i=t.sw,o=t.ne,l={lat:+s.latitude,lng:+s.longitude},c=o.lng<i.lng?l.lng>=i.lng||l.lng<=o.lng:l.lng>=i.lng&&l.lng<=o.lng,r=l.lat>=i.lat&&l.lat<=o.lat&&c;else if(t.type&&"country"==t.type.toLowerCase())r=s.countryCode.toLowerCase()==t.addr.toLowerCase();else{r=[s.regionName.toLowerCase()+","+s.countryCode.toLowerCase(),s.regionCode.toLowerCase()+","+s.countryCode.toLowerCase()].indexOf((t.addr||"").toLowerCase())>-1}var i,o,l,c;return C(e,r)}async function f(t,n,s){let r=a.getIPAddress();if(e.empty(r)){if(r=await c.fetch("https://us-central1-mimir-181311.cloudfunctions.net/get_ip").then((e=>e.text())).then((e=>JSON.parse(e).userIP)).catch((()=>{})),e.empty(r))return!1;await a.setIPAddress(r)}function i(e){var t=e.trim().split("."),n=(t[0]?t[0]*Math.pow(256,3):0)+(t[1]?t[1]*Math.pow(256,2):0)+(t[2]?t[2]*Math.pow(256,1):0)+t[3];if(n<0)throw new Error(e+" is not a legal host ipaddr");return n}var o,l,u,d,g,m=(n=n||{}).split("-");return o=m[0],l=m[1]||o,C(t,(u=o,d=l,(g=i(r))>=i(u)&&g<=i(d)))}async function y(t,n,s,r){let i=await u.arequire("float-match");var a;await e.DOMContentLoaded();var o=n.target,l=!e.contains(n.target.charAt(0),"#",".");n.targetType?("class"==n.targetType&&l&&(o="."+o),"id"==n.targetType&&l&&(o="#"+o)):l&&(o="#"+o);var c=e.qs(o);e.empty(c)?(a=C(t,"notExists"==n.matchType),n.matchType):a=C(t,i(e.parseNodeValue(c),n.matchType,n.value));return a}async function E(e,t,n,s,r){var i=(n||[]).length,a=!1;if(!i)return!0;for(d({msgs:["include"==t?"Show":"Hide"," campaign if value is one of:"],styles:["normal-bold","normal"]});i--;)if(d({msgs:[" - ",JSON.stringify(n[i])],styles:["normal","italic"]}),a=await e(t,n[i],s,r),"include"==t){if(a)return d({msgs:["   Value matched"],styles:["normal-bold"]}),!0;d({msgs:["   Value didn't match"],styles:["normal-bold"]})}else{if(!a)return d({msgs:["   Value matched"],styles:["normal-bold"]}),!1;d({msgs:["   Value didn't match"],styles:["normal-bold"]})}return a}function S(t){var n,s=[];for(Array.isArray(t)||(t=e.JSON.parse(t)),n=t.length;n--;){let e="matchType"in t[n]?t[n]:t[n].value;s.unshift(e)}return s}function v(t){var n={};return"string"==e.typeStr(t)&&(t=e.JSON.parse(t)),t.include&&(n.include=S(t.include)),t.exclude&&(n.exclude=S(t.exclude)),n}function I(t){return"string"==e.typeStr(t)&&(t=e.JSON.parse(t)),t}function C(e,t){return"exclude"==e?!t:t}return{includeNote:async function(t,n=[]){const s=async()=>{let s=t.rules&&t.rules.groups||[];let r=!1,i=!0;if(s.some((t=>!e.empty(t.conditions)))){d({msgs:["Conditions"],styles:["group"],type:"groupCollapsed"});for(let e=0;e<s.length;e++){try{r=await this.evaluateGroup(s[e].conditions,s[e].conditionAnd,t,n)}catch(e){console.error(e)}i=s[e].groupAnd?i&&r:i||r}d({type:"groupEnd"}),d(i?{msgs:["Conditions passed"],styles:["success"]}:{msgs:["Conditions didn't pass"],styles:["error"]})}else d({msgs:["Campaign has ","no conditions"],styles:["normal","normal-bold"]});return i};if(!t.targeting||t.targeting.doNotUse)return await s();d({msgs:["Targeting"],styles:["group"],type:"groupCollapsed"});try{const e=await l.evaluate(t);let n;return d({type:"groupEnd"}),e?(d({msgs:["Targeting passed"],styles:["success"]}),n=await s()):(s(),d({msgs:["Targeting didn't passed"],styles:["error"]})),e&&n}catch(e){console.log(e)}},evaluateArraySome:E,evaluateGroup:async function(t,n,s,r){var i,a,o,l,c=0,u=n;if(!t||!t.length)return!0;for(d({msgs:["Group ",n?"AND":"OR"," has ",t.length," conditions:"],styles:["normal","normal-bold","normal","normal-bold","normal"]});c<t.length;c++){i=t[c];var g=this.evaluatorFunctions[i.type].formatValue,m=this.evaluatorFunctions[i.type].evaluate;"object"==e.typeStr(i)&&(l=g?g(i.value):i.value,o=i.matchType,a=!(!r||!~r.indexOf(i.type))||await m(n,o,l,s,i),u=n?u&&a:u||a)}return u},evaluatorFunctions:{1:{evaluate:function(e,t,n,s){function r(e){function t(e){return"/"==e[e.length-1]?e.substring(0,e.length-1):e}function n(e){return"www."==e.substring(0,4)?e.substring(4,e.length):e}const s=u.location,r=function(e){try{const t=e.includes("http")?e:`https://${e}`;return new c.URL(t)}catch(e){console.error(e)}}(e);return["hostname","pathname","search","hash"].every((e=>{let i=s[e],a=r[e];if(("search"==e||"hash"==e)&&!a)return!0;if("hostname"==e&&(i=n(i),a=n(a)),"pathname"==e&&(a=t(a),i=t(i),a.includes("*"))){let[e,n]=a.split("*");e=t(e);const s=!e||t(i.substring(0,e.length)).toUpperCase()==e.toUpperCase(),r=!n||i.substring(i.length-n.length,i.length).toUpperCase()==n.toUpperCase();return s&&r}return a.toUpperCase()==i.toUpperCase()}))}var i=a.getSequence(s.CampaignId);d({msgs:["- Sequence"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if sequence",` ${"include"==t?"matches":"doesn't match"} `,n],styles:["normal","normal-bold","italic"]}),i.length<n.length&&(r(n[i.length])?i.push(1):i.length-1>=0&&r(n[i.length-1])||(i.length=0));let o;d({msgs:["Pages visited from sequence: ",i.length],styles:["normal","normal-bold"]}),a.setSequence(s.CampaignId,i),i.length==n.length?(d({msgs:["Sequence matched"],styles:["normal-bold"]}),o=C(t,!0)):(d({msgs:["Sequence didn't match"],styles:["normal-bold"]}),"exclude"==t&&(o=!0));d({type:"groupEnd"}),d(o?{msgs:["  Sequence passed"],styles:["success"]}:{msgs:["  Sequence didn't pass"],styles:["error"]});return o},formatValue:S},2:{evaluate:async function(e,s,r,i){let o=await a.isSubscribed();d({msgs:["- Newsletter Subscriber"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if user ",("include"==s?"is":"is not")+" ","subscribed to the newsletter"],styles:["normal","normal-bold","normal"]}),o||(o=n.isSubscribedFromQuery||r.extraParam&&~String(t.get(n)).indexOf(r.extraParam),o&&a.setSubscription());!o&&r.extraParam&&(o=~String(t.get(n)).indexOf(r.extraParam));o=r.value?o&&r.value:o&&r;d(o?{msgs:["User ","is"," subscribed already"],styles:["normal","normal-bold","normal"]}:{msgs:["User ","is not"," subscribed yet"],styles:["normal","normal-bold","normal"]});var l=C(s,o);d({type:"groupEnd"}),d(l?{msgs:["  Newsletter Subscriber passed"],styles:["success"]}:{msgs:["  Newsletter Subscriber didn't pass"],styles:["error"]});return l},formatValue:function(t){"boolean"!=e.typeStr(t)&&(t=e.JSON.parse(t));return t}},3:{evaluate:function(e,t,n,s){d({msgs:["- New Visitor"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if user ",("include"==t?"is":"is not")+" ","a new visitor"],styles:["normal","normal-bold","normal"]});const r=a.newVisitor;d(r?{msgs:["User ","is"," a new visitor"],styles:["normal","normal-bold","normal"]}:{msgs:["User ","is not"," a new visitor"],styles:["normal","normal-bold","normal"]});var i=C(t,r);d({type:"groupEnd"}),d(i?{msgs:["  New Visitor passed"],styles:["success"]}:{msgs:["  New Visitor didn't pass"],styles:["error"]});return i}},4:{evaluate:g(m),formatValue:v},5:{evaluate:function(s,r,i,o){d({msgs:["- Specific Query"],type:"groupCollapsed",styles:["group"]});var l=a.getQueryInclude(o.CampaignId);const u=t.get(n).queryParams();if(d({msgs:["Current queries are: ",c.replaceAll?JSON.stringify(u).replaceAll(":","="):JSON.stringify(u)],styles:["normal","normal-bold"]}),e.empty(u)&&l){const e=l>0;return d(e?{msgs:["This condition was already evaluated to pass in this session"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session"],styles:["error"]}),e}{const l=function(s,r,i,o){function l(s,r,i,a){e.empty(i)||d({msgs:["include"==r?"Show":"Hide"," campaign if we have this queries: ",`${i.map((e=>`${e[0].key}=${e[0].value}`)).join(", ")}`],styles:["normal-bold","normal","normal-bold"]});var o=t.get(n).queryParams(),l=0;if(i.length){if(i.forEach((function(e){var t=e[0].key,n=e[0].value;t in o&&o[t]==n&&l++})),l==i.length)return d({msgs:["Queries ","found"],styles:["normal","normal-bold"]}),l="include"==r?1:-1;l=0,d({msgs:["Queries ","not found"],styles:["normal","normal-bold"]})}return l}var c,u,g=a.getQueryInclude(o.CampaignId);if(c=l(0,"exclude",i.exclude||[]))return s||(r="exclude"),a.setQueryInclude(o.CampaignId,c),{result:!1,matchType:r};if(u=l(0,"include",i.include||[]))return a.setQueryInclude(o.CampaignId,u),{result:!0,matchType:r};if(!c&&!u){const e=g?g>0:!(i.include||[]).length;return d(e?{msgs:["This condition was already evaluated to pass in this session, ignoring condition result"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session, ignoring condition result"],styles:["error"]}),{result:e,matchType:r}}}(s,r,i,o);return r=l.matchType,d({type:"groupEnd"}),l.result?d({msgs:["  Specific Query passed"],styles:["success"]}):d({msgs:["  Specific Query didn't pass"],styles:["error"]}),l.result}},formatValue:v},6:{evaluate:function(t,n,s,r){d({msgs:["- Specific Referral"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Show campaign if referral ",""+("include"==n?"is":"is not")," one of ",s],styles:["normal","normal-bold","normal","italic"]});var i=a.getReferral();d({msgs:["Current referral is ",i||"none"],styles:["normal","normal-bold"]});var o=i&&s.some((function(t){return t.split(",").some((function(t){return e.cleanUpReferral(t).toLowerCase()==i.toLowerCase()}))}));d(o?{msgs:["Referral matched"],styles:["normal-bold"]}:{msgs:["Referral didn't match"],styles:["normal-bold"]});var l=C(n,o);d({type:"groupEnd"}),d(l?{msgs:["  Specific Referral passed"],styles:["success"]}:{msgs:["  Specific Referral didn't pass"],styles:["error"]});return l},formatValue:S},7:{evaluate:function(e,s,r,i){function o(e,t,n){var s,r,i,a=e.split(",");for(s=0;s<t.length;s++)for(i=t[s].matchType,r=0;r<a.length;r++)if("exactMatch"==i){if(t[s].value==a[r])return!0}else if("contains"==i&&~a[r].indexOf(t[s].value))return!0}d({msgs:["- UTM Campaign"],type:"groupCollapsed",styles:["group"]});let l="";Object.keys(r).forEach((e=>{l+=`\n - ${e}: `,r[e].forEach(((t,n)=>{l+=`${"exactMatch"==t.matchType?"matches":"contains"} ${t.value}`,n!=r[e].length-1&&(l+=" or ")}))})),d({msgs:[""+("include"==s?"Show":"Hide")," campaign if UTM queries: ",l],styles:["normal-bold","normal","italic"]});var u=t.get(n).queryParams();d({msgs:["Current queries are ",c.replaceAll?JSON.stringify(u).replaceAll(":","="):JSON.stringify(u)],styles:["normal","normal-bold"]});var g=a.getUTMInclude(i.CampaignId);if(g){const e=g>0;return d(e?{msgs:["This condition was already evaluated to pass in this session"],styles:["success"]}:{msgs:["This condition was already evaluated to not pass in this session"],styles:["error"]}),d({type:"groupEnd"}),d(e?{msgs:["  UTM Campaign passed"],styles:["success"]}:{msgs:["  UTM Campaign didn't pass"],styles:["error"]}),e}var m=function(e,t){var n,s,r;for(n in t)if(t.hasOwnProperty(n)){for(r in s=!0,e)if(n.toLowerCase()==r.toLowerCase()&&(s=!1,!o(e[r],t[n])))return!1;if(s)return!1}return!0}(u,r);d(m?{msgs:["UTM queries matched"],styles:["normal-bold"]}:{msgs:["UTM queries didn't match"],styles:["normal-bold"]});var p=C(s,m);a.setUTMInclude(i.CampaignId,p?1:-1),d({type:"groupEnd"}),d(p?{msgs:["  UTM Campaign passed"],styles:["success"]}:{msgs:["  UTM Campaign didn't pass"],styles:["error"]});return p},formatValue:I},8:{evaluate:function(e,t,n,s){if(s.hiddenSleeknote)return!0;d({msgs:["- Show Count"],type:"groupCollapsed",styles:["group"]}),d({msgs:["Hide"," campaign when show count is ",n],styles:["normal-bold","normal","normal-bold"]});var r=a.getShowCount(s.CampaignId);d({msgs:["Current show count is ",r],styles:["normal","normal-bold"]});const i=r>=n;d(i?{msgs:["Show Count matched"],styles:["normal-bold"]}:{msgs:["Show Count didn't match"],styles:["normal-bold"]});var o=C(t,i);d({type:"groupEnd"}),d(o?{msgs:["  Show Count passed"],styles:["success"]}:{msgs:["  Show Count didn't pass"],styles:["error"]});return o}},9:{evaluate:async function(e,t,n,s){let r=await u.arequire("float-match");function a(e,t,n){function s(e,t,n){if(!t.target){var s=(t.value||t).split("=");t={target:s[0],matchType:s.length>1?"exactMatch":"exists",value:s[1]}}var a=i.getItem(t.target,!0);null===a&&d({msgs:["  ",t.target," not found"],styles:["normal","italic","normal-bold"]});const o=r(a,t.matchType,t.value);return null!=a&&d({msgs:["  Cookie ",a," "+(o?"matched":"didn't match")],styles:["normal","italic","normal-bold"]}),C(e,o)}t||(t=[]);var a=t.length;if(!a)return!0;const o=t.map((e=>`${e.target} ${e.matchType}${"exists"!=e.matchType?` ${e.value}`:""}`)).join("include"==e?" and ":" or ");if(d({msgs:[""+("include"==e?"Show":"Hide")," campaign if: ",o],styles:["normal-bold","normal","normal-bold"]}),"include"!=e){for(;a--;)if(!s(e,t[a]))return d({msgs:["Hide cookies matched"],styles:["normal-bold"]}),!1;return d({msgs:["Hide cookies didn't match"],styles:["normal-bold"]}),!0}for(;a--;)if(!s(e,t[a])){d({msgs:["Show cookies didn't match"],styles:["normal-bold"]});break}return-1==a?(d({msgs:["Show cookies matched"],styles:["normal-bold"]}),!0):void 0}d({msgs:["- Specific Cookie"],type:"groupCollapsed",styles:["group"]});var o=a("exclude",n.exclude);o?o=a("include",n.include):e||"exclude";d({type:"groupEnd"}),d(o?{msgs:["  Specific Cookie passed"],styles:["success"]}:{msgs:["  Specific Cookie didn't pass"],styles:["error"]});return o},formatValue:v},10:{evaluate:g(p),formatValue:v},11:{evaluate:g(h),formatValue:v},12:{evaluate:g(y),formatValue:I},13:{evaluate:async function(t,n,r,i){let a=await u.arequire("float-match");function o(t,n,r){let i=e.findPropValue(s.getSession(r.NS),n.target);return C(t,a(i,n.matchType,n.value))}function l(e,t,n,s){if(!(n=n||[]).length)return!0;d({msgs:["include"==t?"Show":"Hide"," campaign if SiteData values are:"],styles:["normal-bold","normal"]});var r=n.every((function(n){d({msgs:[" - ",`${n.target} ${n.matchType}${"exists"==n.matchType||"notexists"==n.matchType?"":` ${n.value}`}`],styles:["normal","italic"]});var r=e(t,n,s);return"include"!=t&&(r=!r),d(r?{msgs:["  SiteData value matched"],styles:["normal-bold"]}:{msgs:["  SiteData value didn't match"],styles:["normal-bold"]}),r}));return"include"==t?r:!r}d({msgs:["- SiteData"],type:"groupCollapsed",styles:["group"]});var c=l(o,"exclude",r.exclude,i);c?c=l(o,"include",r.include,i):t||"exclude";d({type:"groupEnd"}),d(c?{msgs:["  SiteData passed"],styles:["success"]}:{msgs:["  SiteData didn't pass"],styles:["error"]});return c},formatValue:I},14:{evaluate:function(e,t,n,s){var i=0;d({msgs:["- Pages Visited"],type:"groupCollapsed",styles:["group"]}),d({msgs:["include"==t?"Show":"Hide"," campaign if user has visited more than ",n.value," pages during ",n.option],styles:["normal-bold","normal","normal-bold","normal","normal-bold"]}),o=n.option,l=s.CampaignId,i=o==r.CONDITIONS.PAGESVISITEDOPTIONS.ONESESSION?a.getPagesVisitedCountPerSession(l)||0:a.getPagesVisitedCount(l)||0,function(e,t){e!=r.CONDITIONS.PAGESVISITEDOPTIONS.ONESESSION||a.getPagesVisitedCountPerSessionSetted(t)?e!=r.CONDITIONS.PAGESVISITEDOPTIONS.ALLSESSIONS||a.getPagesVisitedCountSetted(t)||(i+=1,a.setPagesVisitedCount(t,i),a.setPagesVisitedCountSetted(t,!0)):(i+=1,a.setPagesVisitedCountPerSession(t,i),a.setPagesVisitedCountPerSessionSetted(t,!0))}(n.option,s.CampaignId),d({msgs:["Current number of Pages Visited is: ",i],styles:["normal","normal-bold"]});var o,l;const c=n.value<=i;var u=C(t,c);d(c?{msgs:["Pages Visited matched"],styles:["normal-bold"]}:{msgs:["Pages Visited didn't match"],styles:["normal-bold"]});d({type:"groupEnd"}),d(u?{msgs:["  Pages Visited passed"],styles:["success"]}:{msgs:["  Pages Visited didn't pass"],styles:["error"]});return u},formatValue:I},15:{evaluate:g(f),formatValue:v}},evaluateURL:m,containsURL:p,containsGEOID:h,containsIPAddress:f,evaluateHtmlElementValue:y,match:C}})),sndefine("preprocessor-utils",["browser","constants","core-sleeknote","evaluator","utils","storage-instance","location"],(function(e,t,n,s,r,i,a){var o=this,l=o.document,c=t.PROFILE;let u=t.POS;function d(){return e.is.phone&&n.hasCustomProp("isRealMobileSite")?!!n.custom("isRealMobileSite"):!e.is.phone||e.notScaledMobileContent()}function g(t,s){var r;if(s?r=(n.editor||n.preview)&&"test"!=n.editor?"mobile"==(n.editor||n.preview).profile?c.MOBILE:c.DESKTOP:e.is.desktop?c.DESKTOP:e.is.tablet?c.TABLET:c.MOBILE:(n.hasCustomProp("displayStatus")&&(r=n.custom("displayStatus")(e,n,t,c)),n.hasCustomProp("displayStatus")&&void 0!==r||(r=c.IGNORE,Array.isArray(t.rules.display)?e.is.desktop?~t.rules.display.indexOf(1)&&(r=c.DESKTOP):e.is.tablet?~t.rules.display.indexOf(1)&&(r=c.TABLET):~t.rules.display.indexOf(2)&&(r=c.MOBILE):e.is.desktop?~[1,3].indexOf(t.rules.display)&&(r=c.DESKTOP):e.is.tablet?~[1,2].indexOf(t.rules.display)&&(r=c.TABLET):~[1,2].indexOf(t.rules.display)&&(r=c.MOBILE))),!s){let s=d();r!=c.MOBILE||s||(r=n.hasCustomProp("displayStatus")&&n.custom("displayStatus")(e,n,t,c)==c.MOBILE?c.MOBILE:c.TABLET)}return r}function m(e){return e==c.MOBILE?1:0}function p(e,t,n,s){var r=n[e];return Array.isArray(r)&&(r=r[m(s)]),void 0===r&&(r=t),r}function h(e,t){return+e.Version||2}function f(e,t){return y(e,t)==u.EMBEDDED}function y(e,t){let n=g(e,t),s=+p("BoxAndBarAlignment",u.POPUP,e,n);return s==u.POPUP&&(s=n==c.MOBILE?u.SLIDEUP:u.POPUP2),n!=c.TABLET||r.contains(s,u.HELLO,u.HELLO2,u.EMBEDDED,u.SIDEBAR_RIGHT,u.SIDEBAR_LEFT)||(s=s==u.BOTTOM_LEFT?u.POPUP7:s==u.BOTTOM_RIGHT?u.POPUP9:u.POPUP5),n==c.MOBILE&&(s<=u.BOTTOM_RIGHT||s==u.POPUP2)&&(s=u.SLIDEUP),s}function E(e,t){return p("placement",void 0,e,f(e,t)?c.DESKTOP:g(e,t))}function S(e,t){let n=h(e)>3;return n&&e.steps.forEach((e=>{let t,n,s,i,a=!1;for(let o of r.values(e))"form"==o.type&&(n=o),"teaser"==o.type&&(s=o),"success"==o.type&&(i=o),a?"form"==o.type&&(o.teaser=t.name,t.success=o.name):a=o,t=o,delete o.teasers,delete o.successes;s?(a.teaser=s.name,s.form=a.name):delete a.teaser,i?n.success=i.name:delete n.success})),n?e.steps[m(g(e,t))]:e.steps}var v={};return{isRealMobileSite:d,teaserExist:function(e){let t=S(e);return!!Object.keys(t).filter((function(e){return"teaser"==t[e].type})).length},deleteTeaserIf:function(e){e&&e.steps&&Object.keys(e.steps).forEach((function(t){"teaser"==e.steps[t].type&&delete e.steps[t]}))},parseOnClick:async function(e){let t;try{await r.DOMContentLoaded(),t=JSON.parse(e),t.selector=(t.classes||[]).reduce((function(e,t){try{l.body.querySelector("."+t.value)&&e.push("."+t.value)}catch(n){const s="."+o.CSS.escape(t.value);l.body.querySelector(s)&&e.push(s)}return e}),[]).concat((t.ids||[]).reduce((function(e,t){try{l.body.querySelector("#"+t.value)&&e.push("#"+t.value)}catch(e){}return e}),[])).join(","),(t.selector&&l.body.querySelectorAll(t.selector)||[]).length||(t=!1)}catch(e){t=!1}return t},getProfile:g,getPlacement:E,isAnyConditions:function(e){for(var t=e.rules&&e.rules.groups||[],n=0;n<t.length;n++)if(t[n].conditions&&t[n].conditions.length)return!0;return!1},getVersion:h,isSleekbar:function(e,t){return r.contains(y(e,t),u.HELLO,u.HELLO2)},isEmbedded:f,getPosition:y,getShowTeaser:function(e,t){return p("ShowTeaser",!1,e,g(e,t))},getSteps:S,evaluate:async function(e,t,n){let i;if(t)i=!0;else try{e.CampaignId in v?i=v[e.CampaignId]:(i=await s.includeNote(e,n),v[e.CampaignId]=i)}catch(t){console.log("evaluator error:",e.CampaignId,t),v[e.CampaignId]=i=!1}if(i){if(y(e,t)==u.EMBEDDED){i=!1;let n=E(e,t);if(n){await r.DOMContentLoaded();try{i=!!r.gid(n)}catch(e){}}}}return i},resetEvaluator:function(){v={}},getConfProp:function(e,t,n){return p(e,t,n,g(n,!1))},isCorrectDomain:function(e){if(!0===n.local||void 0===e.Hostname||n.preview)return!0;return a.get(n).domainMatches(e.Hostname)},isSessionHidden:function(e){return!n.preview&&i.isSessionHidden(e.CampaignId)},isSessionClosed:function(e){return!n.preview&&i.isSessionClosed(e.CampaignId)}}})),sndefine("preprocessor",["browser","utils","core-sleeknote","storage-instance","logger","constants","preprocessor-utils","global"],(function(e,t,n,s,r,i,a,o){var l=i.PROFILE,c=i.POS;let{getProfile:u,getPlacement:d,getVersion:g,isSleekbar:m,isEmbedded:p,getPosition:h,getShowTeaser:f,getSteps:y,evaluate:E,resetEvaluator:S,getConfProp:v,isCorrectDomain:I,isSessionHidden:C,isSessionClosed:w,parseOnClick:T,teaserExist:O,deleteTeaserIf:b}=a;var N=this;async function A(e,n,s,a){if(!Array.isArray(e))return[];let c,d={};e.length&&(e.forEach((function(e){e.Version<=3&&(e.steps={form:{type:"form",teaser:"teaser"}});let t=u(e,n),s=O(e)&&t==l.MOBILE;(m(e)||p(e)||s)&&(e.rules.triggers=s?e.rules.triggers.filter((e=>2==e.type||4==e.type||5==e.type)):[],e.smarts=void 0),m(e)&&b(e)})),e.some((function(e,t){let s=u(e,n);return s!=l.MOBILE&&s!=l.IGNORE?e.smarts:void 0}))&&(c=await N.arequire("split-tests"),({splitTests:d,sleekNotes:e}=c.generateFromSmarts(e,n))));let g=r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG),h=[];S(),n||g({msgs:["CAMPAIGNS:"],styles:["color: rgb(84, 87, 255); font-weight: bold; font-size: 16px;"],type:"group"});for(let[l,c]of t.entries(e)){g=c.smartIndex&&"1"!=c.smartIndex[0]||n?()=>{}:r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG);let e=c.campaignName;try{e=o.decodeURI(e),e=o.decodeURI(e)}catch(e){}g({msgs:[`${e} - ${c.CampaignId}`],type:"groupCollapsed",styles:["group"]});try{var f=await P(c,d,l,n,g,s,a)}catch(e){}g({type:"groupEnd"}),g(f?{msgs:["INCLUDED"],styles:["success"]}:{msgs:["REJECTED"],styles:["error"]}),h.push(f)}!c&&h.some((function(e,t){return e&&e.splitTestId}))&&(c=await N.arequire("split-tests"));let y=c?c.filterConfig(h,d,n):h.filter((e=>e));return n||console.groupEnd(),y}async function P(e,a,o,S,b,A,P){function k(t,n){for(var s=e.rules.triggers.length;s--;)if(e.rules.triggers[s].type==t)return e.rules.triggers[s].value;return n}const R=0===k(1,void 0)?-1:k(1,0),D=0===k(2,void 0)?-1:k(2,0),M=k(5,!1);var L={options:e.advOptions||[],profile:u(e,S),campaignId:e.CampaignId,type:e.SleeknoteType,customerId:e.CustomerId,summaryId:e.summaryId,smartIndex:e.smartIndex,version:g(e,S),triggers:e.rules.triggers,campaignName:e.campaignName,integrationName:e.integrationName,placement:d(e,S),splitTestId:e.SplitTestId,wait:w(e)?0:1e3*R,exit:!w(e)&&k(3,!1),scroll:!w(e)&&D,hidden:k(4,!1),onClick:M&&await T(M),siteData:k(7,!1),multimerge:e.multimerge,NS:e.NS,campaignType:e.campaignType,quizOutcomes:e.quizOutcomes};if(L.siteData)try{L.siteData=JSON.parse(L.siteData)}catch(e){L.siteData=!1}let x;if(L.version<4&&(L.successAction=v("SuccessAction",void 0,e),L.successLandingPage=v("SuccessLandingPage",void 0,e)),S)L=t.extend(L,{hidden:!n.editor&&!n.preview}),x=!0,(b=r.log(i.CORE.LOGLEVELS.CS,i.CORE.FORMATTERS.SNDEBUG))({msgs:["SLEEKNOTE MESSAGE:"," manual trigger triggered on rejected campaign, ignoring rules and showing the campaign anyway."],styles:["message","normal-bold"]});else if(791==L.customerId&&n.hasCustomProp("demoCampaignIds")&&n.custom("demoCampaignIds").some((e=>e==L.campaignId)))b({msgs:["Demo campaign always shows"],styles:[""]}),x=!0;else{if(!I(e))return b({msgs:["Campaign domain doesn't match current domain"],styles:["error"]}),void(L.profile=l.IGNORE);if(L.profile<3)return void b({msgs:["Profile(Mobile/Desktop) doesn't match current one"],styles:["error"]});const r=n.getDomainLimits&&n.getDomainLimits()||{},a=r[e.Hostname]||r["All non-selected domains"],o=t.getAdvOption({options:e.advOptions},"impressionOverride",1),c=s.getSessionShowCount(),u=A&&P.includes(e.CampaignId);if(!u&&(void 0!==a&&c>=a)){if(!o)return b({msgs:[`The limit of ${a} impressions for this domain has been reached with ${c} campaigns shown in this session, more info: https://help.sleeknote.com/advanced-use/impression-limit`],styles:["error"]}),void(L.profile=l.IGNORE);b({msgs:["Ignoring impression limit, more info: https://help.sleeknote.com/hc/en-us/articles/7006752027037-Impression-Limit"],styles:["normal"]})}let d=L.multimerge;if(d&&"DateMultiMerge"==d.type){let e,t=new Date,r=[t.getFullYear(),t.getMonth(),t.getDate()];e=void 0!==n.mergeId?d.rows[n.mergeId]:d.rows.find((e=>e[d.id].join()==r.join())),e&&(L.multimergeCurrent=Array.from(e),s.setMergeId(L.campaignId,r));let i=s.getMergeId(L.campaignId,r);Array.isArray(i)&&i.join()!=r.join()&&s.brandNewDay(L.campaignId)}const g=k(5);let h=!u&&C(e);if(h&&!g||(x=await E(e,!1,u&&A)),!x)return h&&!g&&b({msgs:["Campaign is hidden for this session because it has been already seen and closed"],styles:["error"]}),void(L.profile=l.IGNORE);if(!t.empty(e.advOptions)){const t=e.advOptions.find((e=>"note-priority"==e.id));t&&t.values.length&&b({msgs:["Campaign order is ",t.values[0].value],styles:["normal","normal-bold"]})}if(t.empty(e.rules.triggers)||m(e)||p(e)){if(!(m(e)||p(e)||O(e)))return b({msgs:["Campaign doesn't have triggers or teaser so it can't show"],styles:["error"]}),void(L.profile=l.IGNORE);b({msgs:["Campaign has ","no triggers"],styles:["normal","normal-bold"]})}else if(e.smarts&&e.smartIndex&&1==e.smartIndex.substring(0,1))b({msgs:["Campaign trigger is ","automated",", a split-test has been created"],styles:["normal","normal-bold","normal"]});else{b({msgs:["Campaign triggers are:"],styles:["normal"]}),e.rules.triggers.forEach((({type:e})=>{let n=k(e);try{n=JSON.parse(k(e))}catch(e){}switch(e){case 1:b({msgs:[`- ${i.TRIGGERS.TYPES[e]} `,n," seconds"],styles:["normal","normal-bold","normal"]});break;case 2:b({msgs:[`- ${i.TRIGGERS.TYPES[e]} `,n,"%"],styles:["normal","normal-bold","normal"]});break;case 3:case 4:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}`],styles:["normal"]});break;case 5:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}:`],styles:["normal"]});const s=n.classes.map((e=>e.value)).join(", "),r=n.ids.map((e=>e.value)).join(", ");t.empty(s)||b({msgs:["    Classes: ",s],styles:["normal","normal-bold"]}),t.empty(r)||b({msgs:["    Ids: ",r],styles:["normal","normal-bold"]});break;case 7:b({msgs:[`- ${i.TRIGGERS.TYPES[e]}:`],styles:["normal"]}),n.forEach((e=>b({msgs:["    ",`${e.property} ${e.type} ${e.value}`],styles:["normal","normal-bold"]})))}}));const n=L.wait||L.exit||L.scroll||L.hidden||L.onClick||L.siteData;if(!(n||m(e)||O(e)||u))return b({msgs:["Campaign doesnt have teaser and was already triggered this session so it won't show"],styles:["error"]}),void(L.profile=l.IGNORE);n||b({msgs:["Campaign"," has already been triggered this session",", we won't automaticly trigger it again"],styles:["normal","normal-bold","normal"]})}b({msgs:[["ZERO?","UNKN","IGNORE","DESKTOP","TABLET","MOBILE"][L.profile]," version was chosen"],styles:["normal-bold","normal"]})}var U=h(e);if((L.hidden||m(e)||p(e))&&(L.wait=0,L.exit=!1,L.scroll=0),L.version<=3){var B=f(e);B||!1===B||(B=!0),L.profile==l.MOBILE&&L.version<3&&(B=!1),U==c.POPUP&&L.version<3&&(B=!1),(m(e)||1==L.version&&U==c.POPUP2)&&(B=!1),B&&(e.steps.teaser={type:"teaser",form:"form"}),"SuccessStep"==L.successAction?(e.steps.success={type:"success"},e.steps.form.success="success"):"redirect"==L.successAction&&L.successLandingPage?e.steps.form.redirect=L.successLandingPage:delete e.steps.success,delete L.successAction,delete L.successLandingPage}n.tabletUsesMobile=!1,L.position=U;var V=L.profile==l.MOBILE,_=y(e);return L.steps={},L.profile==l.MOBILE&&O(e)&&(L.wait=0),Object.keys(_).forEach((function(n){var s,r=t.extend({},_[n],{name:n,mobile:V,campaignId:L.campaignId,customerId:L.customerId,version:L.version,position:U,placement:L.placement,profile:L.profile,hostname:e.Hostname,noteType:L.type,campaignName:e.name,integrationName:e.integrationName,formElements:e.formElements,NS:L.NS,quizOutcomes:L.quizOutcomes});t.empty(r.redirect)||"string"!=t.typeStr(r.redirect)||(r.redirect=(~(s=r.redirect).indexOf("http://")||~s.indexOf("https://")?"":"//")+s),L.version>3?r.id="#sleeknote-"+n.replace(/[^a-zA-Z0-9\-\_\:\.\[\]]/g,""):r.id="teaser"==r.type?"#sleeknoteMinified":"form"==r.type?"#sleeknoteBox":"#sleeknoteSuccess",L.profile,l.TABLET,L.profile==l.DESKTOP&&(r.relativeWidth=0),t.contains(r.type,"teaser")&&(L.profile,l.TABLET,L.profile==l.DESKTOP&&(r.relativeWidth=0)),L.steps[n]=r})),Object.keys(L.steps).forEach((function(t){var n=L.steps[t];n.timeZoneOffset=e.timeZoneOffset||0,n.timeZone=e.timeZone,n.locale=e.locale||(N.navigator.userLanguage||N.navigator.language).split("-")[0]})),L.splitTestId&&(a[L.splitTestId]||(a[L.splitTestId]=[]),a[L.splitTestId].push(o)),L}return N.dev.generateConfig=A,A})),sndefine("launcher",["core-sleeknote","constants","event-emitter","browser","utils","storage-instance","location","site-data","preprocessor","preprocessor-utils","global","logger"],(function(e,t,n,s,r,i,a,o,l,c,u,d){var g=this,m=g.document;const p=d.log(t.CORE.LOGLEVELS.CS,t.CORE.FORMATTERS.SNDEBUG),h=t.CORE.CREATOR.API,f=t.CORE.COMMANDS;let y,E,S,v=[],I=[],C=Object.create(null),w=Object.create(null),T=[],O=-1,b=String(a.get(e));function N(t){let n="beforeCampaignCreate";return e.hooks[n]&&e.hooks[n](t),!(t.multimerge&&!t.multimergeCurrent)||(p({msgs:[`No mergedata for campaign '${t.campaignId}' was found`],styles:["error"]}),!1)}async function A(e,n){let s=Object.keys(C);c.resetEvaluator(),i.resetMemData();let a=[],o=[];v.forEach((function(e){let t=e.CampaignId;~s.indexOf(t)&&a.push(e),o.push(e)})),I.length=0,T.length=0,O=-1;let l=await L(o,!1,!1,e==t.CORE.EVENTS.SITEDATA&&[2,8,14],a.map((e=>R(e)))),u=l.length;if(a.length&&u)for(;u--;){let e=M(R(l[u]),a);if(~e){if(n){let t=R(a[e]);n(await C[t])}l.splice(u,1),a.splice(e,1)}}for(let e of r.values(a)){let t=R(e),n=await C[t];await k(t,!0),n.destroy(!0,!1,!0)}U(l)}async function P(){let t=a.reset(e);t.matches(b,e.custom("reloadOnHashChange"))||(A(),b=String(t))}async function k(e,t){if(!C[e])return;let n=(await C[e]).config.position,s=M(e,I);if(~s){I.splice(s,1);let e=T.indexOf(n);~e&&T.splice(e,1),O==n&&(O=-1)}t||(s=M(e,v),~s&&v.splice(s,1)),delete C[e],delete w[e]}function R(e){return e.CampaignId||e.campaignId}function D(e){let n,s=v.length;for(;s--;)if(n=v[s],R(n)==e&&c.getProfile(n)>t.PROFILE.IGNORE)return n.hiddenSleeknote=!0,n.SplitTestId="",l([n],!0).then((function(e){let t=e.shift();if(I.push(t),N(t))return H(t)}))}function M(e,t){for(let[n,s]of r.entries(t))if(R(s)==e)return n;return-1}async function L(e,t,n=!0,s,i){let a=[],o=[];if(!e)return o;if(Array.isArray(e)||(e=[e]),e.forEach((e=>{-1==M(R(e),v)&&v.push(e),a.push(e),!E&&r.getAdvOption({options:e.advOptions},"onepagesite",1)&&(E=g.setInterval(P,1e3))})),a.length){(await l(a,t,s,i)).forEach((e=>{M(e.campaignId,I)>-1||(I.push(e),o.push(e))})),o.length&&(o=x(o))}return n&&U(o),S=o,o}function x(n){return e.editor||(n.sort((function(e,t){var n=+r.getAdvOption({options:e.options},"note-priority",1)||0;return(+r.getAdvOption({options:t.options},"note-priority",1)||0)-n})),(n=n.filter((function(e){if(N(e)){if(!e.hidden){var n=e.position;if(n==t.POS.EMBEDDED&&(n=e.placement),T.includes(n)){if(e.onClick)return p({msgs:["Position of campaign ",e.campaignId," is taken, as it has an onClick trigger, we will remove the teaser"],styles:["normal","normal-bold","normal"]}),c.deleteTeaserIf(e),e.exit=!1,e.wait=0,e.scroll=0,e;if(!(e.exit&&O<0))return void p({msgs:["Position of campaign ",e.campaignId," is taken so it won't show"],styles:["normal","normal-bold","normal"]});O=n,c.deleteTeaserIf(e),e.wait=0,e.scroll=0,p({msgs:["Position of campaign ",e.campaignId," is taken, as it has an exit trigger, we will remove the teaser"],styles:["normal","normal-bold","normal"]})}else if(e.exit&&O<0&&(O=n,!c.teaserExist(e)))return e;T.push(n)}return e}}))).sort((function(e,t){function n(n){return e[n]&&t[n]?e[n]-t[n]:t[n]?1:e[n]?-1:void 0}var s;return void 0!==(s=n("scroll"))||void 0!==(s=n("wait"))||void 0!==(s=n("exit"))?s:0}))),n}function U(e){for(var t=e.length;t--;)H(e[t])}var B,V,_,G;async function H(s){let i,a,o=r.extend(s),l=R(o);return l in C?(i=await C[l],["wait","onClick"].forEach((function(e){i.config[e]=o[e]}))):C[l]=new u.Promise((async function(s,r){if(await g.arequire("package-notes"),a=o.position==t.POS.EMBEDDED,a?({EmbeddedCampaign:B,layout:G}=await g.arequire("package-embedded")):({AnchoredCampaign:V,orchestrator:_,layout:G}=await g.arequire("package-anchored")),G.viewport||G.initialize(),i=a?await B.create({config:o}):await V.create({config:o}),i&&!e.editor&&!a){if(o.exit&&$(),o.scroll&&j(),i.teaserExist&&!i.config.hidden&&i.canBeLaunched()&&i.config.wait>=0){let e=i.first("teaser");n(f.QUEUE,{creator:h,name:e,origin:i.notes[e],trigger:"none"})}i.launchTriggers(((e,t)=>{if(("timer"==e||"notification"==e)&&t.canBeLaunched()){let e=t.first("form");n(f.QUEUE,{creator:h,name:e,origin:t.notes[e],trigger:"timer"})}}))}return i?(n(t.CORE.EVENTS.READY,i),w[l]=i,s(i)):r(o)})),C[l]}function $(){s.is.desktop&&(r.listener(m.documentElement,"add",(function(e){if(!e.relatedTarget&&e.clientY<10)for(let e of Object.values(C))e.then((function(e){if(e.ifTrigger("exit")&&e.canBeLaunched()){let t=e.first("form");n(f.OPEN,{creator:h,name:t,origin:e.notes[t],trigger:"exit"})}}))}),!0)("mouseout"),$=()=>{})}function j(){var e,t=function(){y=0;for(let e of Object.values(C))e.then((function(e){if(e.ifTrigger("scroll")&&e.canBeLaunched()){let t=e.first("form");n(f.OPEN,{creator:h,name:t,origin:e.notes[t],trigger:"scroll"})}}))};r.listener(g,"add",(function(n){var s=+new Date;y&&s-y<1e3||(g.clearTimeout(e),e=g.setTimeout(t,2e3),y=s)}),!0)("scroll"),j=()=>{}}function F(e=!0){return{result:e,handled:!0}}m.addEventListener(e.eventName,(function(e){e.data.type==t.CORE.EVENTS.SITEDATA&&A(e.data.type,(function(e){e.triggerOnSiteDataIf()}))}));let q={destructivelyChangeCampaign:function(e,t){let n=M(e,I),s=w[e];if(n<0||!s)return;let r=I[n];return s.destroy(!0),delete C[e],delete w[e],r=t(r,s),H(r)},status:function(){let e={campaigns:{},visible:{}};for(let[t,n]of r.entries(w)){let s=r.extend(n.config);delete s.steps,s.notes=Object.keys(n.notes).map((e=>n.notes[e].config)),e.campaigns[t]=s,"EmbeddedCampaign"==n.kind&&n.visibleNote.noteName&&(e.visible[t]={campaignId:t,name:n.visibleNote.noteName,kind:"EmbeddedCampaign"})}if(_)for(let[t,n]of r.entries(_.visibles))e.visible[t]={campaignId:t,name:n.noteName};return e},API:function({command:e,noteName:n,keep:s,config:r,campaign:i,onlyShowPreloaded:a,campaignId:o}){const l=t.CORE.API;switch(e){case l.EVALUATE:return F(A());case l.ADD:return F(L(r));case l.BUSY:for(let e of Object.values(w))if(e.busy)return F(!0);return F(!1);case l.VISIBLE:return i?i.API({command:e}):F({})}return{handled:!1}},forceLoad:D,add:L,remove:k,createCampaign:H,prioritize:x,preprocessor:l,get rawConfigs(){return v},get includedConfig(){return I},get campaigns(){return C},get campaignsResolved(){return w},get justAdded(){return S},loadForLaunch:async function(e,t){if(t&&i.isSessionClosed(e))return void console.warn("can not show toggler onlyShowPreloaded:"+t+" id:",e);let n=C[e];if(!n&&!t&&(n=D(e),!n))return void console.warn("campaign ",e," failed to load");let s=await n;if(s)return s.config.smartIndex=0,s.tameTeaser(),s;console.warn("campaign ",e," failed to load")},onEvaluate:A};return e.expose(q,"launcher"),q})),sndefine("core-api",["launcher","core-sleeknote","utils","constants","global","storage-instance"],(function(e,t,n,s,r,i){var a=this;const o=s.CORE.API;let l=new a.Set,c={};function u(e,t){return e}function d(t,s){let r=[],i=o.CLOSE,a=e.status().visible;for(let o of n.values(a)){let n=e.campaignsResolved[o.campaignId];if(n&&t&&t.config.campaignId!=o.campaignId)continue;let a=n.API({command:i,ffwd:s,noteName:o.name});a.handled&&r.push(a.result)}return n.allSettled(r).then((function(){return t?[t]:Object.values(a)}))}function g(...m){let p,h,f,y,E,S,v,I,C,w,T,O,b=m[0],N=m[1],A=e.campaignsResolved[N];switch(b){case o.POSITION:f=m[2],//!!!
C=m[3],S=m[4];break;case o.BLINK:p=m[2],S=m[3];break;case o.CLOSEALL:I=m[1];for(let e of l)e.ffwd();return r.Promise.all(Object.keys(e.status().visible).map((e=>g("close",e,I))));case o.STATUS:return u(e.status());case o.CAMPAIGNS:return u(e.campaigns);case o.RESET:E=m[1];break;case o.REMOVE:y=m[2],v=m[3];break;case o.CLOSE:I=m[2];break;case o.OPEN:case o.REVEAL:case o.MAXIMIZE:case o.MINIMIZE:case o.QUEUE:case o.NOTE_CONFIG:p=m[2];break;case o.AFTERRENDER:S=m[2];break;case o.NOTE_RERENDER:S=m[3],p=m[2];break;case o.APPLY_CONFIG:p=m[2],h=m[3];break;case o.ADD:h=m[1];break;case o.MERGE:h=m[1],w=m[2];break;case o.HOOK:T=m[1],S=m[2];break;case o.LAUNCH:O=m[2],p=m[3]}return function({command:l,campaignId:m,noteName:p,config:h,position:f,complete:y,keep:E,callback:S,abrupt:v,ffwd:I,placement:C,mergeId:w,hookName:T,onlyShowPreloaded:O}){let b={handled:!1},N=e.campaignsResolved[m];switch(l){case o.WAIT:return new r.Promise((t=>{let n=()=>{e.API({command:o.BUSY}).result?a.setTimeout(n,100):t()};n()}));case o.EVALUATE:case o.BUSY:b=e.API({command:l});break;case o.VISIBLE:b=e.API({command:l,campaign:N});break;case o.ADD:b=e.API({command:l,config:h});break;case o.REMOVE:N&&(e.remove(m),b=N.API({command:l,abrupt:v,complete:y}));break;case o.CLOSE:b={result:d(N,I),handled:!0};break;case o.AFTERRENDER:N&&(b=N.API({command:l,callback:S}));break;case o.POSITION:if(N){let t=f==s.POS.EMBEDDED;if(t&&!C)break;if(N.config.position==f){b={result:r.Promise.resolve(),handled:!0};break}let n=e.destructivelyChangeCampaign(m,(function(e){e.position=f;for(let n of Object.keys(e.steps))e.steps[n].position=f,t&&(e.steps[n].placement=C);return t&&(e.placement=C),S&&(e=S(e)),e}));b={result:n,handled:!0}}break;case o.MAXIMIZE:case o.MINIMIZE:case o.OPEN:case o.REVEAL:case o.QUEUE:if(N){if(n.contains(l,o.OPEN,o.REVEAL)&&t.editor)for(let t of Object.values(e.status().visible))t.campaignId!=m&&("EmbeddedCampaign"!=t.kind&&"EmbeddedCampaign"!=N.kind||g("close",t.campaignId));b=N.API({command:l,noteName:p})}break;case o.NOTE_RERENDER:N&&(b=N.API({command:l,noteName:p,callback:S}));break;case o.NOTE_CONFIG:N&&(b=N.API({command:l,noteName:p}));break;case o.APPLY_CONFIG:N&&(b=N.API({command:l,noteName:p,config:h}));break;case o.MERGE:let c=h.multimerge;if(h.multimergeCurrent=[],c&&"DateMultiMerge"==c.type){let e;e=Array.isArray(w)?c.rows.find((e=>e[c.id].join()==w.join())):c.rows[w],e&&(h.multimergeCurrent=Array.from(e),i.setMergeId(h.campaignId,w))}b={handled:!0,result:h.multimergeCurrent};break;case o.HOOK:t.hooks[T]=S,b.handled=!0;break;case o.LAUNCH:b=e.loadForLaunch(m,O).then((function(e){return e?(p||(p=e.first("form")),e.notes[p]?e.API({command:"open",noteName:p}):(console.warn("noteName ",p," does not exist in ",e),{handled:!1})):{handled:!1}}));break;default:console.warn("Unknown API command:",l)}if(b.handled){let e=u(b.result);return b.result,r.Promise,e}if(n.contains(l,o.MAXIMIZE,o.MINIMIZE,o.OPEN,o.REVEAL,o.QUEUE,o.CLOSE))return l!=o.CLOSE&&(t.editor&&(c={}),c[m]={campaignId:m,noteName:p,command:l}),r.Promise.resolve()}({campaign:A,command:b,campaignId:N,noteName:p,config:h,position:f,complete:y,keep:E,callback:S,abrupt:v,ffwd:I,placement:C,mergeId:w,hookName:T,onlyShowPreloaded:O})}return a.document.addEventListener(t.eventName,(function(e){if(e.type==t.eventName){let{type:t,animator:n,status:r,campaignId:i}=e.data;if(t==s.CORE.EVENTS.ANIMATING)l[r?"add":"delete"](n);else if(t==s.CORE.EVENTS.READY&&i in c){let{command:t,noteName:n}=c[i];delete c[i],n in e.data.boxes&&g(t,i,n)}}})),g})),sndefine("package-core-boot",["launcher","core-sleeknote","event-emitter","core-api","constants","storage-instance","browser","site-data"],(function(e,t,n,s,r,i,a,o){return{launcher:e,coreConfig:t,emit:n,API:s,CONST:r,storage:i,B:a,siteData:o}}));